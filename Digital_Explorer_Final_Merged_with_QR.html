<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Digital Explorer ‚Äî Interactive Tech Adventure (Merged)</title>
  <style>
    :root{
      --paper:#FFF8EA;
      --ink:#14202B;
      --muted:#4B5B6A;

      --orange:#F08A24;
      --teal:#2A9D8F;
      --green:#6FB56D;
      --pink:#D6455D;

      --card:#FFFFFFCC;
      --stroke:#15202B1A;
      --shadow: 0 14px 34px rgba(17,24,39,.12);
      --r1:22px;
      --r2:16px;
    }

    *{box-sizing:border-box}
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
      color:var(--ink);
      background:
        radial-gradient(900px 520px at 12% -10%, rgba(240,138,36,.22), transparent 60%),
        radial-gradient(900px 520px at 92% 0%, rgba(42,157,143,.20), transparent 62%),
        radial-gradient(900px 560px at 55% 110%, rgba(111,181,109,.18), transparent 65%),
        linear-gradient(180deg, #FFFDF7, var(--paper));
    }

    header{
      position:sticky; top:0; z-index:20;
      background: rgba(255,255,255,.88);
      backdrop-filter: blur(10px);
      border-bottom:1px solid var(--stroke);
    }

    .topbar{
      max-width:1180px; margin:0 auto;
      display:flex; align-items:center; justify-content:space-between;
      padding:12px 16px; gap:12px;
      flex-wrap:wrap;
    }

    .brand{display:flex; align-items:center; gap:12px; min-width: 260px;}
    .logo{
      width:44px; height:44px; border-radius:14px;
      display:grid; place-items:center;
      font-weight:900;
      background: linear-gradient(135deg, rgba(240,138,36,.22), rgba(42,157,143,.18));
      border:1px solid var(--stroke);
      box-shadow: var(--shadow);
    }
    .brand h1{margin:0; font-size:16px; letter-spacing:.2px}
    .brand p{margin:3px 0 0; font-size:12px; color:var(--muted)}

    .controls{display:flex; align-items:center; gap:10px; flex-wrap:wrap; justify-content:flex-end}
    .pill{
      display:flex; align-items:center; gap:8px;
      padding:8px 10px;
      border-radius:999px;
      background: rgba(42,157,143,.10);
      border:1px solid rgba(42,157,143,.18);
      font-size:12px;
    }
    .progress{
      height:10px; width:220px;
      border-radius:999px;
      background: rgba(20,32,43,.07);
      overflow:hidden;
      border:1px solid var(--stroke);
    }
    .progress > div{
      height:100%;
      width:0%;
      background: linear-gradient(90deg, rgba(240,138,36,.90), rgba(42,157,143,.90));
      border-radius:999px;
      transition: width .25s ease;
    }

    .btn{
      cursor:pointer;
      padding:10px 12px;
      border-radius:14px;
      border:1px solid var(--stroke);
      background: rgba(255,255,255,.75);
      color:var(--ink);
      box-shadow: 0 10px 18px rgba(17,24,39,.10);
      font-weight:650;
      display:flex; align-items:center; gap:8px;
      transition: transform .12s ease, background .12s ease;
      user-select:none;
    }
    .btn:hover{transform: translateY(-1px); background: rgba(255,255,255,.92);}
    .btn:active{transform: translateY(0px) scale(.99)}
    .btn.primary{
      background: linear-gradient(135deg, rgba(240,138,36,.18), rgba(42,157,143,.14));
      border-color: rgba(42,157,143,.22);
    }
    .btn.ghost{opacity:.88}

    .tabs{
      display:flex; gap:10px; align-items:center;
      padding: 0 16px 12px;
      max-width:1180px;
      margin:0 auto;
    }
    .tab{
      padding:10px 12px;
      border-radius: 999px;
      border:1px solid var(--stroke);
      background: rgba(255,255,255,.68);
      cursor:pointer;
      font-weight:700;
      font-size:12px;
    }
    .tab.active{
      background: rgba(42,157,143,.14);
      border-color: rgba(42,157,143,.24);
    }

    .layout{
      max-width:1180px; margin:18px auto 70px;
      display:grid;
      grid-template-columns: 300px 1fr;
      gap:16px;
      padding: 0 16px;
    }
    @media (max-width: 980px){
      .layout{grid-template-columns:1fr}
      .controls{justify-content:flex-start}
      .progress{width:180px}
    }

    .panel{
      background: var(--card);
      border:1px solid var(--stroke);
      border-radius: var(--r1);
      box-shadow: var(--shadow);
    }

    .sidebar{position:sticky; top:128px; align-self:start; overflow:hidden}
    .pad{padding:14px}
    .search{
      width:100%;
      padding:10px 12px;
      border-radius:14px;
      border:1px solid var(--stroke);
      background: rgba(255,255,255,.85);
      color:var(--ink);
      outline:none;
    }
    .nav{
      padding: 0 8px 12px;
      display:flex; flex-direction:column; gap:6px;
      max-height: 62vh;
      overflow:auto;
    }
    .nav button{
      width:100%;
      text-align:left;
      padding:10px 10px;
      border-radius: 14px;
      border:1px solid transparent;
      background: transparent;
      cursor:pointer;
      display:flex; justify-content:space-between; align-items:center;
      gap:10px;
      color:var(--ink);
      transition: background .12s ease, border-color .12s ease;
    }
    .nav button:hover{background: rgba(20,32,43,.05)}
    .nav button.active{background: rgba(42,157,143,.12); border-color: rgba(42,157,143,.22);}
    .dot{width:10px;height:10px;border-radius:50%;background: rgba(20,32,43,.18);border:1px solid rgba(20,32,43,.18);flex:0 0 auto;}
    .nav button.done .dot{background: rgba(111,181,109,.85);border-color: rgba(111,181,109,.95);}
    .nav small{color:var(--muted)}

    main{overflow:hidden}
    .hero{padding:16px 18px 0;display:flex;justify-content:space-between;align-items:flex-start;gap:12px;flex-wrap:wrap;}
    .hero h2{margin:0; font-size:18px}
    .hero p{margin:6px 0 0; color:var(--muted); max-width:70ch; line-height:1.45}
    .chips{display:flex; gap:8px; flex-wrap:wrap; margin-top:10px}
    .chip{font-size:12px;padding:7px 10px;border-radius:999px;background: rgba(240,138,36,.10);border:1px solid rgba(240,138,36,.18);color: rgba(20,32,43,.85);}

    .stage{padding:16px 18px 18px;border-top:1px solid var(--stroke);}
    .grid{display:grid;grid-template-columns: 1.2fr .8fr;gap:14px;}
    @media (max-width: 980px){ .grid{grid-template-columns:1fr} }

    .card{background: rgba(255,255,255,.90);border:1px solid var(--stroke);border-radius: var(--r2);padding:14px;box-shadow: 0 10px 22px rgba(17,24,39,.08);}

    .viewer{border-radius: var(--r2);overflow:hidden;border:1px solid var(--stroke);background: rgba(255,255,255,.95);box-shadow: 0 10px 22px rgba(17,24,39,.08);min-height: 480px;position:relative;}
    .viewer iframe{width:100%;height: 520px;border:0;display:block;background: white;}

    .footerBtns{display:flex; gap:10px; flex-wrap:wrap; justify-content:flex-end;padding: 12px 18px 18px;border-top:1px solid var(--stroke);background: rgba(255,255,255,.70);}

    .toast{padding:10px 12px;border-radius: 14px;border:1px solid var(--stroke);background: rgba(20,32,43,.03);color: var(--muted);font-size:12px;line-height:1.35;}
    .row{display:flex; gap:10px; flex-wrap:wrap}
    .row > *{flex:1 1 220px}

    /* Flashcards view */
    .flashWrap{
      max-width:1180px;
      margin:18px auto 70px;
      padding: 0 16px;
    }
    .flashPanel{
      background: rgba(255,255,255,.84);
      border:1px solid var(--stroke);
      border-radius: var(--r1);
      box-shadow: var(--shadow);
      overflow:hidden;
    }
    .flashHeader{
      padding:14px 16px;
      display:flex;
      gap:10px;
      align-items:center;
      justify-content:space-between;
      border-bottom:1px solid var(--stroke);
      flex-wrap:wrap;
    }
    .flashHeader h2{margin:0; font-size:16px}
    .flashIframe{
      width:100%;
      height: 900px;
      border:0;
      display:block;
      background:white;
    }

    .hidden{display:none!important}
  </style>
</head>

<body>
<header>
  <div class="topbar">
    <div class="brand">
      <div class="logo">DX</div>
      <div>
        <h1>Digital Explorer ‚Äî Interactive Tech Adventure</h1>
        <p>Merged: Course + Flashcards (single file).</p>
      </div>
    </div>

    <div class="controls">
      <div class="pill">Progress: <strong id="progressText">0%</strong></div>
      <div class="progress"><div id="progressBar"></div></div>
      <button class="btn" id="prevBtn" title="Previous (‚Üê)">‚Üê Prev</button>
      <button class="btn primary" id="nextBtn" title="Next (‚Üí)">Next ‚Üí</button>
    </div>
  </div>

  <div class="tabs" role="tablist" aria-label="Views">
    <button class="tab active" id="tabCourse" role="tab" aria-selected="true">üìö Course</button>
    <button class="tab" id="tabFlash" role="tab" aria-selected="false">üß† Flashcards</button>
    <button class="tab" id="tabQR" role="tab" aria-selected="false">üîó QR Join</button>
  </div>
</header>

<!-- COURSE VIEW -->
<div id="viewCourse">
  <div class="layout">
    <aside class="panel sidebar">
      <div class="pad">
        <input class="search" id="search" placeholder="Search chapters (e.g., hardware, safety)..." />
      </div>
      <div class="nav" id="nav"></div>
      <div class="pad" style="border-top:1px solid var(--stroke)">
        <div class="toast">
          Tips: use <span style="font-family:ui-monospace">‚Üê</span>/<span style="font-family:ui-monospace">‚Üí</span>.
          Your progress auto-saves in this browser.
          <div style="margin-top:8px">
            Put your PDF in the <b>same folder</b> and name it:
            <span style="font-family:ui-monospace">Digital_Explorer_Your_Tech_Adventure.pdf</span>
          </div>
        </div>
      </div>
    </aside>

    <main class="panel">
      <section class="hero">
        <div>
          <h2 id="chapterTitle">Loading‚Ä¶</h2>
          <p id="chapterDesc"></p>
          <div class="chips" id="chips"></div>
        </div>
        <div class="row" style="justify-content:flex-end; flex: 1 1 260px">
          <button class="btn ghost" id="resetBtn">‚Ü∫ Reset</button>
          <button class="btn" id="openPdfBtn">‚§¢ Open PDF (full)</button>
        </div>
      </section>

      <section class="stage">
        <div class="grid">
          <div class="viewer">
            <iframe id="pdfFrame" title="Slide viewer"></iframe>
          </div>
          <div class="card" id="activityCard"></div>
        </div>
      </section>

      <div class="footerBtns">
        <button class="btn ghost" id="markDoneBtn">‚úì Mark chapter done</button>
        <button class="btn" id="jumpQuizBtn">‚ö° Jump to Knowledge Check</button>
        <button class="btn" id="exportBtn">‚¨á Export progress (JSON)</button>
      </div>
    </main>
  </div>
</div>

<!-- FLASHCARDS VIEW -->
<div id="viewFlash" class="hidden">
  <div class="flashWrap">
    <div class="flashPanel">
      <div class="flashHeader">
        <h2>Flashcards (embedded)</h2>
        <div style="display:flex; gap:10px; flex-wrap:wrap">
          <button class="btn ghost" id="flashReloadBtn">‚Üª Reload flashcards</button>
          <button class="btn primary" id="flashOpenNewBtn">‚§¢ Open in new tab</button>
        </div>
      </div>
      <iframe class="flashIframe" id="flashFrame" title="Flashcards"></iframe>
    </div>
    <div class="toast" style="margin-top:12px">
      Note: Flashcards are embedded inside this single HTML file, so you don't need extra files.
    </div>
  </div>
</div>


<!-- QR JOIN VIEW -->
<div id="viewQR" class="hidden">
  <div class="flashWrap">
    <div class="flashPanel">
      <div class="flashHeader">
        <h2>QR Join</h2>
        <div style="display:flex; gap:10px; flex-wrap:wrap">
          <button class="btn ghost" id="qrResetBtn">‚Ü∫ Clear</button>
          <button class="btn primary" id="qrDownloadBtn">‚¨á Download</button>
          <button class="btn" id="qrCopyBtn">üìã Copy</button>
        </div>
      </div>

      <div class="pad" style="display:grid; grid-template-columns: 1fr 360px; gap:14px">
        <div class="card">
          <div style="display:flex; gap:10px; flex-wrap:wrap; margin-bottom:10px">
            <button class="btn ghost" id="qrTabLink">Link / Folder</button>
            <button class="btn ghost" id="qrTabText">Text</button>
            <button class="btn ghost" id="qrTabContact">Contact</button>
          </div>

          <div id="qrFormLink">
            <label style="color:var(--muted); font-size:12px">Paste your join link (Drive folder / Classroom / website)</label>
            <input id="qrLinkInput" class="search" placeholder="example.com or https://example.com" />
            <div class="toast" style="margin-top:10px">
              Tip: Paste your Google Drive folder link here ‚Üí students scan ‚Üí it opens instantly.
            </div>
          </div>

          <div id="qrFormText" class="hidden">
            <label style="color:var(--muted); font-size:12px">Text</label>
            <textarea id="qrTextInput" class="search" style="min-height:120px; resize:vertical" placeholder="Type any text..."></textarea>
          </div>

          <div id="qrFormContact" class="hidden" style="display:grid; gap:10px">
            <div class="row">
              <div>
                <label style="color:var(--muted); font-size:12px">First name</label>
                <input id="qrFirst" class="search" placeholder="John" />
              </div>
              <div>
                <label style="color:var(--muted); font-size:12px">Last name</label>
                <input id="qrLast" class="search" placeholder="Doe" />
              </div>
            </div>
            <div>
              <label style="color:var(--muted); font-size:12px">Phone</label>
              <input id="qrPhone" class="search" placeholder="+1 (555) 123-4567" />
            </div>
            <div>
              <label style="color:var(--muted); font-size:12px">Email</label>
              <input id="qrEmail" class="search" placeholder="john.doe@example.com" />
            </div>
            <div>
              <label style="color:var(--muted); font-size:12px">Organization</label>
              <input id="qrOrg" class="search" placeholder="School / Company" />
            </div>
            <div>
              <label style="color:var(--muted); font-size:12px">Website</label>
              <input id="qrWebsite" class="search" placeholder="https://example.com" />
            </div>
          </div>

          <div style="margin-top:12px">
            <label style="color:var(--muted); font-size:12px">QR Code Data</label>
            <pre id="qrDataBox" class="toast" style="max-height:160px; overflow:auto; white-space:pre-wrap"></pre>
          </div>
        </div>

        <div class="card" style="display:flex; flex-direction:column; align-items:center; justify-content:center; gap:10px">
          <div id="qrOut" style="display:flex; justify-content:center; width:100%"></div>
          <div class="toast" style="text-align:center">
            Scan with a phone camera / QR scanner.
          </div>
        </div>
      </div>
    </div>
  </div>
</div>



<script>
  // ---- Flashcards (embedded) ----
  const FLASHCARDS_B64 = "PCFET0NUWVBFIGh0bWw+CjxodG1sIGxhbmc9ImVuIj4KPGhlYWQ+CiAgICA8bWV0YSBjaGFyc2V0PSJVVEYtOCI+CiAgICA8bWV0YSBuYW1lPSJ2aWV3cG9ydCIgY29udGVudD0id2lkdGg9ZGV2aWNlLXdpZHRoLCBpbml0aWFsLXNjYWxlPTEuMCI+CiAgICA8dGl0bGU+SUNUIEdyYWRlIDUgRmxhc2hjYXJkczwvdGl0bGU+CiAgICA8c3R5bGU+CiAgICAgICAgKiB7CiAgICAgICAgICAgIG1hcmdpbjogMDsKICAgICAgICAgICAgcGFkZGluZzogMDsKICAgICAgICAgICAgYm94LXNpemluZzogYm9yZGVyLWJveDsKICAgICAgICAgICAgZm9udC1mYW1pbHk6ICdBcmlhbCBSb3VuZGVkIE1UIEJvbGQnLCAnQXJpYWwnLCBzYW5zLXNlcmlmOwogICAgICAgIH0KICAgICAgICAKICAgICAgICBib2R5IHsKICAgICAgICAgICAgYmFja2dyb3VuZDogbGluZWFyLWdyYWRpZW50KDEzNWRlZywgIzZhMTFjYiAwJSwgIzI1NzVmYyAxMDAlKTsKICAgICAgICAgICAgbWluLWhlaWdodDogMTAwdmg7CiAgICAgICAgICAgIGRpc3BsYXk6IGZsZXg7CiAgICAgICAgICAgIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47CiAgICAgICAgICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7CiAgICAgICAgICAgIHBhZGRpbmc6IDIwcHg7CiAgICAgICAgICAgIGNvbG9yOiAjMzMzOwogICAgICAgIH0KICAgICAgICAKICAgICAgICAuaGVhZGVyIHsKICAgICAgICAgICAgdGV4dC1hbGlnbjogY2VudGVyOwogICAgICAgICAgICBtYXJnaW4tYm90dG9tOiAzMHB4OwogICAgICAgICAgICBjb2xvcjogd2hpdGU7CiAgICAgICAgICAgIHRleHQtc2hhZG93OiAycHggMnB4IDRweCByZ2JhKDAsIDAsIDAsIDAuMyk7CiAgICAgICAgICAgIG1heC13aWR0aDogODAwcHg7CiAgICAgICAgICAgIHdpZHRoOiAxMDAlOwogICAgICAgIH0KICAgICAgICAKICAgICAgICAuaGVhZGVyIGgxIHsKICAgICAgICAgICAgZm9udC1zaXplOiAyLjhyZW07CiAgICAgICAgICAgIG1hcmdpbi1ib3R0b206IDEwcHg7CiAgICAgICAgICAgIGJhY2tncm91bmQ6IGxpbmVhci1ncmFkaWVudCh0byByaWdodCwgI2ZmN2U1ZiwgI2ZlYjQ3Yik7CiAgICAgICAgICAgIC13ZWJraXQtYmFja2dyb3VuZC1jbGlwOiB0ZXh0OwogICAgICAgICAgICAtd2Via2l0LXRleHQtZmlsbC1jb2xvcjogdHJhbnNwYXJlbnQ7CiAgICAgICAgICAgIGJhY2tncm91bmQtY2xpcDogdGV4dDsKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgLmhlYWRlciBwIHsKICAgICAgICAgICAgZm9udC1zaXplOiAxLjJyZW07CiAgICAgICAgICAgIG9wYWNpdHk6IDAuOTsKICAgICAgICAgICAgbWFyZ2luLWJvdHRvbTogMjBweDsKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgLnN0YXRzIHsKICAgICAgICAgICAgZGlzcGxheTogZmxleDsKICAgICAgICAgICAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7CiAgICAgICAgICAgIGdhcDogMzBweDsKICAgICAgICAgICAgYmFja2dyb3VuZDogcmdiYSgyNTUsIDI1NSwgMjU1LCAwLjE1KTsKICAgICAgICAgICAgcGFkZGluZzogMTVweCAzMHB4OwogICAgICAgICAgICBib3JkZXItcmFkaXVzOiAyMHB4OwogICAgICAgICAgICBiYWNrZHJvcC1maWx0ZXI6IGJsdXIoMTBweCk7CiAgICAgICAgICAgIG1hcmdpbi10b3A6IDEwcHg7CiAgICAgICAgICAgIGZvbnQtd2VpZ2h0OiBib2xkOwogICAgICAgIH0KICAgICAgICAKICAgICAgICAuZmxhc2hjYXJkLWNvbnRhaW5lciB7CiAgICAgICAgICAgIHBlcnNwZWN0aXZlOiAxMDAwcHg7CiAgICAgICAgICAgIHdpZHRoOiAxMDAlOwogICAgICAgICAgICBtYXgtd2lkdGg6IDcwMHB4OwogICAgICAgICAgICBoZWlnaHQ6IDQwMHB4OwogICAgICAgICAgICBtYXJnaW4tYm90dG9tOiAzMHB4OwogICAgICAgIH0KICAgICAgICAKICAgICAgICAuZmxhc2hjYXJkIHsKICAgICAgICAgICAgd2lkdGg6IDEwMCU7CiAgICAgICAgICAgIGhlaWdodDogMTAwJTsKICAgICAgICAgICAgcG9zaXRpb246IHJlbGF0aXZlOwogICAgICAgICAgICB0cmFuc2Zvcm0tc3R5bGU6IHByZXNlcnZlLTNkOwogICAgICAgICAgICB0cmFuc2l0aW9uOiB0cmFuc2Zvcm0gMC44cyBjdWJpYy1iZXppZXIoMC4xNzUsIDAuODg1LCAwLjMyLCAxLjI3NSk7CiAgICAgICAgICAgIGN1cnNvcjogcG9pbnRlcjsKICAgICAgICAgICAgYm9yZGVyLXJhZGl1czogMjVweDsKICAgICAgICAgICAgYm94LXNoYWRvdzogMCAxNXB4IDM1cHggcmdiYSgwLCAwLCAwLCAwLjMpOwogICAgICAgIH0KICAgICAgICAKICAgICAgICAuZmxhc2hjYXJkLmZsaXBwZWQgewogICAgICAgICAgICB0cmFuc2Zvcm06IHJvdGF0ZVkoMTgwZGVnKTsKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgLmNhcmQtZmFjZSB7CiAgICAgICAgICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTsKICAgICAgICAgICAgd2lkdGg6IDEwMCU7CiAgICAgICAgICAgIGhlaWdodDogMTAwJTsKICAgICAgICAgICAgYmFja2ZhY2UtdmlzaWJpbGl0eTogaGlkZGVuOwogICAgICAgICAgICBib3JkZXItcmFkaXVzOiAyNXB4OwogICAgICAgICAgICBkaXNwbGF5OiBmbGV4OwogICAgICAgICAgICBmbGV4LWRpcmVjdGlvbjogY29sdW1uOwogICAgICAgICAgICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjsKICAgICAgICAgICAgYWxpZ24taXRlbXM6IGNlbnRlcjsKICAgICAgICAgICAgcGFkZGluZzogNDBweDsKICAgICAgICAgICAgb3ZlcmZsb3c6IGhpZGRlbjsKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgLmNhcmQtZnJvbnQgewogICAgICAgICAgICBiYWNrZ3JvdW5kOiBsaW5lYXItZ3JhZGllbnQoMTQ1ZGVnLCAjZmZmZmZmLCAjZjBmMGYwKTsKICAgICAgICAgICAgYm9yZGVyOiA4cHggc29saWQgIzRhMDBlMDsKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgLmNhcmQtYmFjayB7CiAgICAgICAgICAgIGJhY2tncm91bmQ6IGxpbmVhci1ncmFkaWVudCgxNDVkZWcsICNmOGZmMDAsICNmZjdlNWYpOwogICAgICAgICAgICB0cmFuc2Zvcm06IHJvdGF0ZVkoMTgwZGVnKTsKICAgICAgICAgICAgYm9yZGVyOiA4cHggc29saWQgI2ZmN2U1ZjsKICAgICAgICAgICAgY29sb3I6ICMzMzM7CiAgICAgICAgfQogICAgICAgIAogICAgICAgIC5xdWVzdGlvbiB7CiAgICAgICAgICAgIGZvbnQtc2l6ZTogMnJlbTsKICAgICAgICAgICAgdGV4dC1hbGlnbjogY2VudGVyOwogICAgICAgICAgICBmb250LXdlaWdodDogYm9sZDsKICAgICAgICAgICAgY29sb3I6ICMyYzNlNTA7CiAgICAgICAgICAgIGxpbmUtaGVpZ2h0OiAxLjQ7CiAgICAgICAgICAgIG1hcmdpbi1ib3R0b206IDIwcHg7CiAgICAgICAgICAgIHBhZGRpbmc6IDAgMjBweDsKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgLmFuc3dlciB7CiAgICAgICAgICAgIGZvbnQtc2l6ZTogMS44cmVtOwogICAgICAgICAgICB0ZXh0LWFsaWduOiBjZW50ZXI7CiAgICAgICAgICAgIGNvbG9yOiAjMmMzZTUwOwogICAgICAgICAgICBsaW5lLWhlaWdodDogMS41OwogICAgICAgICAgICBwYWRkaW5nOiAwIDIwcHg7CiAgICAgICAgfQogICAgICAgIAogICAgICAgIC5oaW50IHsKICAgICAgICAgICAgcG9zaXRpb246IGFic29sdXRlOwogICAgICAgICAgICBib3R0b206IDIwcHg7CiAgICAgICAgICAgIGZvbnQtc2l6ZTogMXJlbTsKICAgICAgICAgICAgY29sb3I6ICM3ZjhjOGQ7CiAgICAgICAgICAgIGZvbnQtc3R5bGU6IGl0YWxpYzsKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgLmNvbnRyb2xzIHsKICAgICAgICAgICAgZGlzcGxheTogZmxleDsKICAgICAgICAgICAgZ2FwOiAyMHB4OwogICAgICAgICAgICBtYXJnaW4tYm90dG9tOiAzMHB4OwogICAgICAgICAgICBmbGV4LXdyYXA6IHdyYXA7CiAgICAgICAgICAgIGp1c3RpZnktY29udGVudDogY2VudGVyOwogICAgICAgIH0KICAgICAgICAKICAgICAgICAuYnRuIHsKICAgICAgICAgICAgcGFkZGluZzogMTVweCAzMHB4OwogICAgICAgICAgICBmb250LXNpemU6IDEuMnJlbTsKICAgICAgICAgICAgZm9udC13ZWlnaHQ6IGJvbGQ7CiAgICAgICAgICAgIGJvcmRlcjogbm9uZTsKICAgICAgICAgICAgYm9yZGVyLXJhZGl1czogNTBweDsKICAgICAgICAgICAgY3Vyc29yOiBwb2ludGVyOwogICAgICAgICAgICB0cmFuc2l0aW9uOiBhbGwgMC4zcyBlYXNlOwogICAgICAgICAgICBkaXNwbGF5OiBmbGV4OwogICAgICAgICAgICBhbGlnbi1pdGVtczogY2VudGVyOwogICAgICAgICAgICBnYXA6IDEwcHg7CiAgICAgICAgICAgIGJveC1zaGFkb3c6IDAgNXB4IDE1cHggcmdiYSgwLCAwLCAwLCAwLjIpOwogICAgICAgIH0KICAgICAgICAKICAgICAgICAuYnRuOmhvdmVyIHsKICAgICAgICAgICAgdHJhbnNmb3JtOiB0cmFuc2xhdGVZKC0zcHgpOwogICAgICAgICAgICBib3gtc2hhZG93OiAwIDhweCAyMHB4IHJnYmEoMCwgMCwgMCwgMC4zKTsKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgLmJ0bjphY3RpdmUgewogICAgICAgICAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZVkoMXB4KTsKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgLmJ0bi1wcmltYXJ5IHsKICAgICAgICAgICAgYmFja2dyb3VuZDogbGluZWFyLWdyYWRpZW50KHRvIHJpZ2h0LCAjNGEwMGUwLCAjOGUyZGUyKTsKICAgICAgICAgICAgY29sb3I6IHdoaXRlOwogICAgICAgIH0KICAgICAgICAKICAgICAgICAuYnRuLXN1Y2Nlc3MgewogICAgICAgICAgICBiYWNrZ3JvdW5kOiBsaW5lYXItZ3JhZGllbnQodG8gcmlnaHQsICMwMGIwOWIsICM5NmM5M2QpOwogICAgICAgICAgICBjb2xvcjogd2hpdGU7CiAgICAgICAgfQogICAgICAgIAogICAgICAgIC5idG4td2FybmluZyB7CiAgICAgICAgICAgIGJhY2tncm91bmQ6IGxpbmVhci1ncmFkaWVudCh0byByaWdodCwgI2ZmN2U1ZiwgI2ZlYjQ3Yik7CiAgICAgICAgICAgIGNvbG9yOiB3aGl0ZTsKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgLmJ0bi1pbmZvIHsKICAgICAgICAgICAgYmFja2dyb3VuZDogbGluZWFyLWdyYWRpZW50KHRvIHJpZ2h0LCAjMjE5M2IwLCAjNmRkNWVkKTsKICAgICAgICAgICAgY29sb3I6IHdoaXRlOwogICAgICAgIH0KICAgICAgICAKICAgICAgICAuYnRuLWRhbmdlciB7CiAgICAgICAgICAgIGJhY2tncm91bmQ6IGxpbmVhci1ncmFkaWVudCh0byByaWdodCwgI2ZmNDE2YywgI2ZmNGIyYik7CiAgICAgICAgICAgIGNvbG9yOiB3aGl0ZTsKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgLnByb2dyZXNzLWNvbnRhaW5lciB7CiAgICAgICAgICAgIHdpZHRoOiAxMDAlOwogICAgICAgICAgICBtYXgtd2lkdGg6IDcwMHB4OwogICAgICAgICAgICBiYWNrZ3JvdW5kOiByZ2JhKDI1NSwgMjU1LCAyNTUsIDAuMik7CiAgICAgICAgICAgIGJvcmRlci1yYWRpdXM6IDEwcHg7CiAgICAgICAgICAgIHBhZGRpbmc6IDVweDsKICAgICAgICAgICAgbWFyZ2luLWJvdHRvbTogMjBweDsKICAgICAgICAgICAgYmFja2Ryb3AtZmlsdGVyOiBibHVyKDEwcHgpOwogICAgICAgIH0KICAgICAgICAKICAgICAgICAucHJvZ3Jlc3MtYmFyIHsKICAgICAgICAgICAgaGVpZ2h0OiAxNXB4OwogICAgICAgICAgICBiYWNrZ3JvdW5kOiBsaW5lYXItZ3JhZGllbnQodG8gcmlnaHQsICMwMGIwOWIsICM5NmM5M2QpOwogICAgICAgICAgICBib3JkZXItcmFkaXVzOiA4cHg7CiAgICAgICAgICAgIHRyYW5zaXRpb246IHdpZHRoIDAuM3MgZWFzZTsKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgLmNhdGVnb3JpZXMgewogICAgICAgICAgICBkaXNwbGF5OiBmbGV4OwogICAgICAgICAgICBmbGV4LXdyYXA6IHdyYXA7CiAgICAgICAgICAgIGdhcDogMTBweDsKICAgICAgICAgICAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7CiAgICAgICAgICAgIG1hcmdpbi10b3A6IDIwcHg7CiAgICAgICAgICAgIG1heC13aWR0aDogODAwcHg7CiAgICAgICAgfQogICAgICAgIAogICAgICAgIC5jYXRlZ29yeS1idG4gewogICAgICAgICAgICBwYWRkaW5nOiAxMHB4IDIwcHg7CiAgICAgICAgICAgIGJhY2tncm91bmQ6IHJnYmEoMjU1LCAyNTUsIDI1NSwgMC4yKTsKICAgICAgICAgICAgYm9yZGVyOiBub25lOwogICAgICAgICAgICBib3JkZXItcmFkaXVzOiA1MHB4OwogICAgICAgICAgICBjb2xvcjogd2hpdGU7CiAgICAgICAgICAgIGN1cnNvcjogcG9pbnRlcjsKICAgICAgICAgICAgdHJhbnNpdGlvbjogYWxsIDAuM3MgZWFzZTsKICAgICAgICAgICAgYmFja2Ryb3AtZmlsdGVyOiBibHVyKDVweCk7CiAgICAgICAgfQogICAgICAgIAogICAgICAgIC5jYXRlZ29yeS1idG46aG92ZXIgewogICAgICAgICAgICBiYWNrZ3JvdW5kOiByZ2JhKDI1NSwgMjU1LCAyNTUsIDAuMyk7CiAgICAgICAgICAgIHRyYW5zZm9ybTogc2NhbGUoMS4wNSk7CiAgICAgICAgfQogICAgICAgIAogICAgICAgIC5jYXRlZ29yeS1idG4uYWN0aXZlIHsKICAgICAgICAgICAgYmFja2dyb3VuZDogI2ZmN2U1ZjsKICAgICAgICAgICAgYm94LXNoYWRvdzogMCAwIDE1cHggcmdiYSgyNTUsIDEyNiwgOTUsIDAuNSk7CiAgICAgICAgfQogICAgICAgIAogICAgICAgIC5pbnN0cnVjdGlvbnMgewogICAgICAgICAgICBiYWNrZ3JvdW5kOiByZ2JhKDI1NSwgMjU1LCAyNTUsIDAuOSk7CiAgICAgICAgICAgIGJvcmRlci1yYWRpdXM6IDIwcHg7CiAgICAgICAgICAgIHBhZGRpbmc6IDI1cHg7CiAgICAgICAgICAgIG1heC13aWR0aDogODAwcHg7CiAgICAgICAgICAgIG1hcmdpbi10b3A6IDMwcHg7CiAgICAgICAgICAgIGJveC1zaGFkb3c6IDAgMTBweCAzMHB4IHJnYmEoMCwgMCwgMCwgMC4yKTsKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgLmluc3RydWN0aW9ucyBoMyB7CiAgICAgICAgICAgIGNvbG9yOiAjNGEwMGUwOwogICAgICAgICAgICBtYXJnaW4tYm90dG9tOiAxNXB4OwogICAgICAgICAgICBmb250LXNpemU6IDEuNXJlbTsKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgLmluc3RydWN0aW9ucyB1bCB7CiAgICAgICAgICAgIGxpc3Qtc3R5bGUtdHlwZTogbm9uZTsKICAgICAgICAgICAgcGFkZGluZy1sZWZ0OiAxMHB4OwogICAgICAgIH0KICAgICAgICAKICAgICAgICAuaW5zdHJ1Y3Rpb25zIGxpIHsKICAgICAgICAgICAgbWFyZ2luLWJvdHRvbTogMTBweDsKICAgICAgICAgICAgcGFkZGluZy1sZWZ0OiAyNXB4OwogICAgICAgICAgICBwb3NpdGlvbjogcmVsYXRpdmU7CiAgICAgICAgICAgIGxpbmUtaGVpZ2h0OiAxLjU7CiAgICAgICAgfQogICAgICAgIAogICAgICAgIC5pbnN0cnVjdGlvbnMgbGk6YmVmb3JlIHsKICAgICAgICAgICAgY29udGVudDogIvCfkYkiOwogICAgICAgICAgICBwb3NpdGlvbjogYWJzb2x1dGU7CiAgICAgICAgICAgIGxlZnQ6IDA7CiAgICAgICAgfQogICAgICAgIAogICAgICAgIC5jb3VudGVyIHsKICAgICAgICAgICAgZm9udC1zaXplOiAxLjNyZW07CiAgICAgICAgICAgIGZvbnQtd2VpZ2h0OiBib2xkOwogICAgICAgICAgICBjb2xvcjogd2hpdGU7CiAgICAgICAgICAgIG1hcmdpbi10b3A6IDEwcHg7CiAgICAgICAgfQogICAgICAgIAogICAgICAgIC8qIEFuaW1hdGlvbiBmb3IgY2FyZCBmbGlwICovCiAgICAgICAgQGtleWZyYW1lcyBjb3JyZWN0QW5zd2VyIHsKICAgICAgICAgICAgMCUgeyB0cmFuc2Zvcm06IHNjYWxlKDEpOyB9CiAgICAgICAgICAgIDUwJSB7IHRyYW5zZm9ybTogc2NhbGUoMS4wNSk7IH0KICAgICAgICAgICAgMTAwJSB7IHRyYW5zZm9ybTogc2NhbGUoMSk7IH0KICAgICAgICB9CiAgICAgICAgCiAgICAgICAgLmNvcnJlY3QtYW5pbWF0aW9uIHsKICAgICAgICAgICAgYW5pbWF0aW9uOiBjb3JyZWN0QW5zd2VyIDAuNXMgZWFzZTsKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgLyogTW9iaWxlIHJlc3BvbnNpdmUgKi8KICAgICAgICBAbWVkaWEgKG1heC13aWR0aDogNzY4cHgpIHsKICAgICAgICAgICAgLmhlYWRlciBoMSB7CiAgICAgICAgICAgICAgICBmb250LXNpemU6IDJyZW07CiAgICAgICAgICAgIH0KICAgICAgICAgICAgCiAgICAgICAgICAgIC5mbGFzaGNhcmQtY29udGFpbmVyIHsKICAgICAgICAgICAgICAgIGhlaWdodDogMzUwcHg7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgCiAgICAgICAgICAgIC5xdWVzdGlvbiB7CiAgICAgICAgICAgICAgICBmb250LXNpemU6IDEuNnJlbTsKICAgICAgICAgICAgfQogICAgICAgICAgICAKICAgICAgICAgICAgLmFuc3dlciB7CiAgICAgICAgICAgICAgICBmb250LXNpemU6IDEuNHJlbTsKICAgICAgICAgICAgfQogICAgICAgICAgICAKICAgICAgICAgICAgLmJ0biB7CiAgICAgICAgICAgICAgICBwYWRkaW5nOiAxMnB4IDIwcHg7CiAgICAgICAgICAgICAgICBmb250LXNpemU6IDFyZW07CiAgICAgICAgICAgIH0KICAgICAgICAgICAgCiAgICAgICAgICAgIC5jb250cm9scyB7CiAgICAgICAgICAgICAgICBnYXA6IDEwcHg7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgCiAgICAgICAgQG1lZGlhIChtYXgtd2lkdGg6IDQ4MHB4KSB7CiAgICAgICAgICAgIC5mbGFzaGNhcmQtY29udGFpbmVyIHsKICAgICAgICAgICAgICAgIGhlaWdodDogMzAwcHg7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgCiAgICAgICAgICAgIC5xdWVzdGlvbiB7CiAgICAgICAgICAgICAgICBmb250LXNpemU6IDEuM3JlbTsKICAgICAgICAgICAgfQogICAgICAgICAgICAKICAgICAgICAgICAgLmFuc3dlciB7CiAgICAgICAgICAgICAgICBmb250LXNpemU6IDEuMnJlbTsKICAgICAgICAgICAgfQogICAgICAgICAgICAKICAgICAgICAgICAgLmJ0biB7CiAgICAgICAgICAgICAgICBwYWRkaW5nOiAxMHB4IDE1cHg7CiAgICAgICAgICAgICAgICBmb250LXNpemU6IDAuOXJlbTsKICAgICAgICAgICAgfQogICAgICAgICAgICAKICAgICAgICAgICAgLnN0YXRzIHsKICAgICAgICAgICAgICAgIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47CiAgICAgICAgICAgICAgICBnYXA6IDEwcHg7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICA8L3N0eWxlPgogICAgPGxpbmsgcmVsPSJzdHlsZXNoZWV0IiBocmVmPSJodHRwczovL2NkbmpzLmNsb3VkZmxhcmUuY29tL2FqYXgvbGlicy9mb250LWF3ZXNvbWUvNi40LjAvY3NzL2FsbC5taW4uY3NzIj4KPC9oZWFkPgo8Ym9keT4KICAgIDxkaXYgY2xhc3M9ImhlYWRlciI+CiAgICAgICAgPGgxPjxpIGNsYXNzPSJmYXMgZmEtbGFwdG9wLWNvZGUiPjwvaT4gSUNUIEdyYWRlIDUgRmxhc2hjYXJkczwvaDE+CiAgICAgICAgPHA+SW50ZXJhY3RpdmUgbGVhcm5pbmcgdG9vbCBmb3IgSW5mb3JtYXRpb24gYW5kIENvbW11bmljYXRpb24gVGVjaG5vbG9neTwvcD4KICAgICAgICA8ZGl2IGNsYXNzPSJzdGF0cyI+CiAgICAgICAgICAgIDxkaXY+VG90YWwgQ2FyZHM6IDxzcGFuIGlkPSJ0b3RhbENhcmRzIj40MDwvc3Bhbj48L2Rpdj4KICAgICAgICAgICAgPGRpdj5NYXN0ZXJlZDogPHNwYW4gaWQ9Im1hc3RlcmVkQ291bnQiPjA8L3NwYW4+PC9kaXY+CiAgICAgICAgICAgIDxkaXY+Q3VycmVudDogPHNwYW4gaWQ9ImN1cnJlbnRDYXJkIj4xPC9zcGFuPi88c3BhbiBpZD0idG90YWxDYXJkczIiPjQwPC9zcGFuPjwvZGl2PgogICAgICAgIDwvZGl2PgogICAgPC9kaXY+CiAgICAKICAgIDxkaXYgY2xhc3M9InByb2dyZXNzLWNvbnRhaW5lciI+CiAgICAgICAgPGRpdiBjbGFzcz0icHJvZ3Jlc3MtYmFyIiBpZD0icHJvZ3Jlc3NCYXIiIHN0eWxlPSJ3aWR0aDogMi41JTsiPjwvZGl2PgogICAgPC9kaXY+CiAgICAKICAgIDxkaXYgY2xhc3M9ImZsYXNoY2FyZC1jb250YWluZXIiPgogICAgICAgIDxkaXYgY2xhc3M9ImZsYXNoY2FyZCIgaWQ9ImZsYXNoY2FyZCI+CiAgICAgICAgICAgIDxkaXYgY2xhc3M9ImNhcmQtZmFjZSBjYXJkLWZyb250Ij4KICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9InF1ZXN0aW9uIiBpZD0icXVlc3Rpb24iPldoYXQgZG9lcyB0aGUgYWNyb255bSBJQ1Qgc3RhbmQgZm9yPzwvZGl2PgogICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iaGludCI+Q2xpY2sgdGhlIGNhcmQgb3IgcHJlc3MgU1BBQ0UgdG8gZmxpcDwvZGl2PgogICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgPGRpdiBjbGFzcz0iY2FyZC1mYWNlIGNhcmQtYmFjayI+CiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJhbnN3ZXIiIGlkPSJhbnN3ZXIiPkluZm9ybWF0aW9uIGFuZCBDb21tdW5pY2F0aW9uIFRlY2hub2xvZ3kuPC9kaXY+CiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJoaW50Ij5DbGljayB0aGUgY2FyZCBvciBwcmVzcyBTUEFDRSB0byBmbGlwIGJhY2s8L2Rpdj4KICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgPC9kaXY+CiAgICA8L2Rpdj4KICAgIAogICAgPGRpdiBjbGFzcz0iY29udHJvbHMiPgogICAgICAgIDxidXR0b24gY2xhc3M9ImJ0biBidG4tcHJpbWFyeSIgaWQ9InByZXZCdG4iPgogICAgICAgICAgICA8aSBjbGFzcz0iZmFzIGZhLWFycm93LWxlZnQiPjwvaT4gUHJldmlvdXMKICAgICAgICA8L2J1dHRvbj4KICAgICAgICA8YnV0dG9uIGNsYXNzPSJidG4gYnRuLXdhcm5pbmciIGlkPSJmbGlwQnRuIj4KICAgICAgICAgICAgPGkgY2xhc3M9ImZhcyBmYS1zeW5jLWFsdCI+PC9pPiBGbGlwIENhcmQKICAgICAgICA8L2J1dHRvbj4KICAgICAgICA8YnV0dG9uIGNsYXNzPSJidG4gYnRuLXN1Y2Nlc3MiIGlkPSJuZXh0QnRuIj4KICAgICAgICAgICAgTmV4dCA8aSBjbGFzcz0iZmFzIGZhLWFycm93LXJpZ2h0Ij48L2k+CiAgICAgICAgPC9idXR0b24+CiAgICAgICAgPGJ1dHRvbiBjbGFzcz0iYnRuIGJ0bi1pbmZvIiBpZD0ic2h1ZmZsZUJ0biI+CiAgICAgICAgICAgIDxpIGNsYXNzPSJmYXMgZmEtcmFuZG9tIj48L2k+IFNodWZmbGUKICAgICAgICA8L2J1dHRvbj4KICAgICAgICA8YnV0dG9uIGNsYXNzPSJidG4gYnRuLWRhbmdlciIgaWQ9InJlc2V0QnRuIj4KICAgICAgICAgICAgPGkgY2xhc3M9ImZhcyBmYS1yZWRvIj48L2k+IFJlc2V0IFByb2dyZXNzCiAgICAgICAgPC9idXR0b24+CiAgICA8L2Rpdj4KICAgIAogICAgPGRpdiBjbGFzcz0iY291bnRlciI+CiAgICAgICAgPGkgY2xhc3M9ImZhcyBmYS1zdGFyIj48L2k+IENhcmQgPHNwYW4gaWQ9ImNhcmRDb3VudGVyIj4xPC9zcGFuPiBvZiA8c3BhbiBpZD0idG90YWxDb3VudGVyIj40MDwvc3Bhbj4KICAgIDwvZGl2PgogICAgCiAgICA8ZGl2IGNsYXNzPSJjYXRlZ29yaWVzIj4KICAgICAgICA8YnV0dG9uIGNsYXNzPSJjYXRlZ29yeS1idG4gYWN0aXZlIiBkYXRhLWNhdGVnb3J5PSJhbGwiPkFsbCBDYXJkczwvYnV0dG9uPgogICAgICAgIDxidXR0b24gY2xhc3M9ImNhdGVnb3J5LWJ0biIgZGF0YS1jYXRlZ29yeT0iYmFzaWNzIj5JQ1QgQmFzaWNzPC9idXR0b24+CiAgICAgICAgPGJ1dHRvbiBjbGFzcz0iY2F0ZWdvcnktYnRuIiBkYXRhLWNhdGVnb3J5PSJoYXJkd2FyZSI+SGFyZHdhcmU8L2J1dHRvbj4KICAgICAgICA8YnV0dG9uIGNsYXNzPSJjYXRlZ29yeS1idG4iIGRhdGEtY2F0ZWdvcnk9InNvZnR3YXJlIj5Tb2Z0d2FyZTwvYnV0dG9uPgogICAgICAgIDxidXR0b24gY2xhc3M9ImNhdGVnb3J5LWJ0biIgZGF0YS1jYXRlZ29yeT0ic2FmZXR5Ij5TYWZldHkgJiBVc2U8L2J1dHRvbj4KICAgICAgICA8YnV0dG9uIGNsYXNzPSJjYXRlZ29yeS1idG4iIGRhdGEtY2F0ZWdvcnk9ImV4YW1wbGVzIj5FeGFtcGxlczwvYnV0dG9uPgogICAgPC9kaXY+CiAgICAKICAgIDxkaXYgY2xhc3M9Imluc3RydWN0aW9ucyI+CiAgICAgICAgPGgzPjxpIGNsYXNzPSJmYXMgZmEtZ3JhZHVhdGlvbi1jYXAiPjwvaT4gSG93IHRvIFVzZSBUaGVzZSBGbGFzaGNhcmRzOjwvaDM+CiAgICAgICAgPHVsPgogICAgICAgICAgICA8bGk+PHN0cm9uZz5DbGljayB0aGUgY2FyZDwvc3Ryb25nPiBvciBwcmVzcyA8c3Ryb25nPlNQQUNFPC9zdHJvbmc+IHRvIGZsaXAgYW5kIHNlZSB0aGUgYW5zd2VyPC9saT4KICAgICAgICAgICAgPGxpPlVzZSA8c3Ryb25nPuKGkCDihpIgYXJyb3cga2V5czwvc3Ryb25nPiB0byBuYXZpZ2F0ZSBiZXR3ZWVuIGNhcmRzPC9saT4KICAgICAgICAgICAgPGxpPkNsaWNrIGNhdGVnb3J5IGJ1dHRvbnMgdG8gZmlsdGVyIGNhcmRzIGJ5IHRvcGljPC9saT4KICAgICAgICAgICAgPGxpPkNsaWNrIDxzdHJvbmc+U2h1ZmZsZTwvc3Ryb25nPiB0byByYW5kb21pemUgdGhlIGNhcmQgb3JkZXI8L2xpPgogICAgICAgICAgICA8bGk+Q2xpY2sgPHN0cm9uZz5SZXNldCBQcm9ncmVzczwvc3Ryb25nPiB0byBzdGFydCBvdmVyPC9saT4KICAgICAgICAgICAgPGxpPlRyeSB0byByZWNhbGwgdGhlIGFuc3dlciBiZWZvcmUgZmxpcHBpbmcgdGhlIGNhcmQhPC9saT4KICAgICAgICA8L3VsPgogICAgPC9kaXY+CgogICAgPHNjcmlwdD4KICAgICAgICAvLyBGbGFzaGNhcmQgZGF0YSBmcm9tIENTVgogICAgICAgIGNvbnN0IGZsYXNoY2FyZERhdGEgPSBbCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIHF1ZXN0aW9uOiAiV2hhdCBkb2VzIHRoZSBhY3JvbnltIElDVCBzdGFuZCBmb3I/IiwKICAgICAgICAgICAgICAgIGFuc3dlcjogIkluZm9ybWF0aW9uIGFuZCBDb21tdW5pY2F0aW9uIFRlY2hub2xvZ3kuIiwKICAgICAgICAgICAgICAgIGNhdGVnb3J5OiAiYmFzaWNzIgogICAgICAgICAgICB9LAogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBxdWVzdGlvbjogIkluIHRoZSBjb250ZXh0IG9mIElDVCwgd2hhdCBkb2VzICdJbmZvcm1hdGlvbicgcmVmZXIgdG8/IiwKICAgICAgICAgICAgICAgIGFuc3dlcjogIkZhY3RzLCBkYXRhLCBvciBzdG9yaWVzLCBzdWNoIGFzIGEgd2VhdGhlciByZXBvcnQgb3IgYSBzY2hvb2wgcHJvamVjdC4iLAogICAgICAgICAgICAgICAgY2F0ZWdvcnk6ICJiYXNpY3MiCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIHF1ZXN0aW9uOiAiSW4gdGhlIGNvbnRleHQgb2YgSUNULCB3aGF0IGRvZXMgJ0NvbW11bmljYXRpb24nIHJlZmVyIHRvPyIsCiAgICAgICAgICAgICAgICBhbnN3ZXI6ICJUaGUgd2F5IHdlIHNlbmQgYW5kIHJlY2VpdmUgaW5mb3JtYXRpb24sIGxpa2Ugc2VuZGluZyBhbiBlbWFpbCBvciBoYXZpbmcgYSB2aWRlbyBjYWxsLiIsCiAgICAgICAgICAgICAgICBjYXRlZ29yeTogImJhc2ljcyIKICAgICAgICAgICAgfSwKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgcXVlc3Rpb246ICJJbiB0aGUgY29udGV4dCBvZiBJQ1QsIHdoYXQgZG9lcyAnVGVjaG5vbG9neScgcmVmZXIgdG8/IiwKICAgICAgICAgICAgICAgIGFuc3dlcjogIlRoZSBtYWNoaW5lcyB3ZSB1c2UsIHN1Y2ggYXMgbGFwdG9wcywgdGFibGV0cywgYW5kIHNtYXJ0cGhvbmVzLiIsCiAgICAgICAgICAgICAgICBjYXRlZ29yeTogImJhc2ljcyIKICAgICAgICAgICAgfSwKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgcXVlc3Rpb246ICJXaGF0IGlzIHRoZSBmaXJzdCBzdGFnZSBpbiBhIGNvbXB1dGVyJ3Mgb3BlcmF0aW9uLCB3aGVyZSBpdCB0YWtlcyBpbiBmYWN0cz8iLAogICAgICAgICAgICAgICAgYW5zd2VyOiAiSW5wdXQuIiwKICAgICAgICAgICAgICAgIGNhdGVnb3J5OiAiYmFzaWNzIgogICAgICAgICAgICB9LAogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBxdWVzdGlvbjogIldoYXQgaXMgdGhlIHNlY29uZCBzdGFnZSBpbiBhIGNvbXB1dGVyJ3Mgb3BlcmF0aW9uLCB3aGVyZSBpdCB0aGlua3MgYWJvdXQgaW5mb3JtYXRpb24gaW5zaWRlIHRoZSBDUFU/IiwKICAgICAgICAgICAgICAgIGFuc3dlcjogIlByb2Nlc3MuIiwKICAgICAgICAgICAgICAgIGNhdGVnb3J5OiAiYmFzaWNzIgogICAgICAgICAgICB9LAogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBxdWVzdGlvbjogIldoYXQgaXMgdGhlIGZpbmFsIHN0YWdlIGluIGEgY29tcHV0ZXIncyBvcGVyYXRpb24sIHdoZXJlIGl0IGdpdmVzIHVzIGFuIGFuc3dlciBvciByZXN1bHQ/IiwKICAgICAgICAgICAgICAgIGFuc3dlcjogIk91dHB1dC4iLAogICAgICAgICAgICAgICAgY2F0ZWdvcnk6ICJiYXNpY3MiCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIHF1ZXN0aW9uOiAiQW55IHBoeXNpY2FsIHBhcnQgb2YgdGhlIGNvbXB1dGVyIHRoYXQgeW91IGNhbiB0b3VjaCBpcyBjYWxsZWQgX19fX18uIiwKICAgICAgICAgICAgICAgIGFuc3dlcjogIkhhcmR3YXJlLiIsCiAgICAgICAgICAgICAgICBjYXRlZ29yeTogImhhcmR3YXJlIgogICAgICAgICAgICB9LAogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBxdWVzdGlvbjogIldoYXQgaXMgdGhlIGZ1bmN0aW9uIG9mIGEgY29tcHV0ZXIgbW9uaXRvcj8iLAogICAgICAgICAgICAgICAgYW5zd2VyOiAiSXQncyB0aGUgc2NyZWVuIHRoYXQgc2hvd3MgeW91IHBpY3R1cmVzLCB2aWRlb3MsIGFuZCB0ZXh0LiIsCiAgICAgICAgICAgICAgICBjYXRlZ29yeTogImhhcmR3YXJlIgogICAgICAgICAgICB9LAogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBxdWVzdGlvbjogIldoYXQgaXMgdGhlIGZ1bmN0aW9uIG9mIGEgY29tcHV0ZXIga2V5Ym9hcmQ/IiwKICAgICAgICAgICAgICAgIGFuc3dlcjogIkl0IGhhcyBidXR0b25zIHdpdGggbGV0dGVycywgbnVtYmVycywgYW5kIHN5bWJvbHMgdXNlZCBmb3IgdHlwaW5nLiIsCiAgICAgICAgICAgICAgICBjYXRlZ29yeTogImhhcmR3YXJlIgogICAgICAgICAgICB9LAogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBxdWVzdGlvbjogIldoYXQgaXMgdGhlIGZ1bmN0aW9uIG9mIGEgbW91c2Ugb3IgdG91Y2hwYWQ/IiwKICAgICAgICAgICAgICAgIGFuc3dlcjogIkl0IG1vdmVzIHRoZSBjdXJzb3Igb24gdGhlIHNjcmVlbiBzbyB5b3UgY2FuIHNlbGVjdCB0aGluZ3MuIiwKICAgICAgICAgICAgICAgIGNhdGVnb3J5OiAiaGFyZHdhcmUiCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIHF1ZXN0aW9uOiAiVGhlIFN5c3RlbSBVbml0LCBvZnRlbiBjYWxsZWQgdGhlIENQVSBib3gsIGlzIGtub3duIGFzIHRoZSAnX19fX18nIG9mIHRoZSBjb21wdXRlci4iLAogICAgICAgICAgICAgICAgYW5zd2VyOiAiYnJhaW4iLAogICAgICAgICAgICAgICAgY2F0ZWdvcnk6ICJoYXJkd2FyZSIKICAgICAgICAgICAgfSwKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgcXVlc3Rpb246ICJXaGljaCBwaWVjZSBvZiBoYXJkd2FyZSBhbGxvd3MgeW91IHRvIGhlYXIgc291bmRzLCBtdXNpYywgb3IgdmlkZW9zIGZyb20gYSBjb21wdXRlcj8iLAogICAgICAgICAgICAgICAgYW5zd2VyOiAiU3BlYWtlcnMuIiwKICAgICAgICAgICAgICAgIGNhdGVnb3J5OiAiaGFyZHdhcmUiCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIHF1ZXN0aW9uOiAiV2hhdCBwcm92aWRlcyBlbGVjdHJpY2l0eSB0byBhIGxhcHRvcCBvciBjb21wdXRlcj8iLAogICAgICAgICAgICAgICAgYW5zd2VyOiAiVGhlIFBvd2VyIENhYmxlLiIsCiAgICAgICAgICAgICAgICBjYXRlZ29yeTogImhhcmR3YXJlIgogICAgICAgICAgICB9LAogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBxdWVzdGlvbjogIlRoZSBzZXQgb2YgcHJvZ3JhbXMgYW5kIGludmlzaWJsZSBpbnN0cnVjdGlvbnMgdGhhdCB0ZWxsIHRoZSBoYXJkd2FyZSB3aGF0IHRvIGRvIGlzIGNhbGxlZCBfX19fXy4iLAogICAgICAgICAgICAgICAgYW5zd2VyOiAiU29mdHdhcmUuIiwKICAgICAgICAgICAgICAgIGNhdGVnb3J5OiAic29mdHdhcmUiCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIHF1ZXN0aW9uOiAiV2hhdCBhcmUgcHJvZ3JhbXMgbGlrZSBQYWludCwgR29vZ2xlIENocm9tZSwgb3IgTWluZWNyYWZ0IGFsc28gY2FsbGVkPyIsCiAgICAgICAgICAgICAgICBhbnN3ZXI6ICJBcHBzIG9yIEFwcGxpY2F0aW9ucy4iLAogICAgICAgICAgICAgICAgY2F0ZWdvcnk6ICJzb2Z0d2FyZSIKICAgICAgICAgICAgfSwKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgcXVlc3Rpb246ICJXaGF0IGlzIHRoZSBtYWluIHByb2dyYW0sIGxpa2UgV2luZG93cyBvciBtYWNPUywgdGhhdCBtYWtlcyBldmVyeXRoaW5nIG9uIGEgY29tcHV0ZXIgd29yayB0b2dldGhlcj8iLAogICAgICAgICAgICAgICAgYW5zd2VyOiAiVGhlIE9wZXJhdGluZyBTeXN0ZW0gKE9TKS4iLAogICAgICAgICAgICAgICAgY2F0ZWdvcnk6ICJzb2Z0d2FyZSIKICAgICAgICAgICAgfSwKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgcXVlc3Rpb246ICJXaGF0IGlzIHRoZSBwcm9jZXNzIG9mIHR1cm5pbmcgYSBjb21wdXRlciBvbiBhbmQgd2FpdGluZyBmb3IgdGhlIHNjcmVlbiB0byBsaWdodCB1cCBjYWxsZWQ/IiwKICAgICAgICAgICAgICAgIGFuc3dlcjogIkJvb3RpbmcuIiwKICAgICAgICAgICAgICAgIGNhdGVnb3J5OiAic2FmZXR5IgogICAgICAgICAgICB9LAogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBxdWVzdGlvbjogIkhvdyBkbyB5b3UgJ2NsaWNrJyB0byBzZWxlY3Qgc29tZXRoaW5nIHVzaW5nIGEgdG91Y2hwYWQ/IiwKICAgICAgICAgICAgICAgIGFuc3dlcjogIlRhcCBnZW50bHkgb24gdGhlIHRvdWNocGFkIG9uY2UuIiwKICAgICAgICAgICAgICAgIGNhdGVnb3J5OiAic2FmZXR5IgogICAgICAgICAgICB9LAogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBxdWVzdGlvbjogIkhvdyBkbyB5b3UgJ2RvdWJsZS1jbGljaycgdG8gb3BlbiBzb21ldGhpbmcgdXNpbmcgYSB0b3VjaHBhZD8iLAogICAgICAgICAgICAgICAgYW5zd2VyOiAiVGFwIHR3aWNlIHF1aWNrbHkgb24gdGhlIHRvdWNocGFkLiIsCiAgICAgICAgICAgICAgICBjYXRlZ29yeTogInNhZmV0eSIKICAgICAgICAgICAgfSwKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgcXVlc3Rpb246ICJXaGF0IGlzIHRoZSBuYW1lIG9mIHRoZSBjb21tb24ga2V5Ym9hcmQgbGF5b3V0IHdoZXJlIHRoZSBsZXR0ZXJzIGFyZSBub3QgaW4gYWxwaGFiZXRpY2FsIG9yZGVyPyIsCiAgICAgICAgICAgICAgICBhbnN3ZXI6ICJRV0VSVFkuIiwKICAgICAgICAgICAgICAgIGNhdGVnb3J5OiAic2FmZXR5IgogICAgICAgICAgICB9LAogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBxdWVzdGlvbjogIldoYXQgaXMgdGhlIGZ1bmN0aW9uIG9mIHRoZSBsb25nIGJhciBhdCB0aGUgYm90dG9tIG9mIHRoZSBrZXlib2FyZD8iLAogICAgICAgICAgICAgICAgYW5zd2VyOiAiVGhlIFNwYWNlIEJhciBtYWtlcyBzcGFjZXMgYmV0d2VlbiB3b3Jkcy4iLAogICAgICAgICAgICAgICAgY2F0ZWdvcnk6ICJzYWZldHkiCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIHF1ZXN0aW9uOiAiV2hpY2gga2V5IGRvIHlvdSBwcmVzcyB0byBtb3ZlIHRvIHRoZSBuZXh0IGxpbmUgd2hlbiB0eXBpbmc/IiwKICAgICAgICAgICAgICAgIGFuc3dlcjogIlRoZSBFbnRlciBLZXkuIiwKICAgICAgICAgICAgICAgIGNhdGVnb3J5OiAic2FmZXR5IgogICAgICAgICAgICB9LAogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBxdWVzdGlvbjogIldoYXQgaXMgdGhlIG1vc3QgaW1wb3J0YW50IHNhZmV0eSBydWxlIHJlZ2FyZGluZyBsaXF1aWRzIG5lYXIgYSBsYXB0b3A/IiwKICAgICAgICAgICAgICAgIGFuc3dlcjogIktlZXAgZHJpbmtzIGZhciBhd2F5IGZyb20gbGFwdG9wcyBiZWNhdXNlIHNwaWxscyBjYW4gYnJlYWsgdGhlbS4iLAogICAgICAgICAgICAgICAgY2F0ZWdvcnk6ICJzYWZldHkiCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIHF1ZXN0aW9uOiAiV2h5IGlzIGl0IGltcG9ydGFudCB0byBoYXZlIGNsZWFuIGFuZCBkcnkgaGFuZHMgYmVmb3JlIHVzaW5nIGEgY29tcHV0ZXI/IiwKICAgICAgICAgICAgICAgIGFuc3dlcjogIlRvIGtlZXAgdGhlIGNvbXB1dGVyIGNsZWFuIGZyb20gZGlydCBhbmQgc211ZGdlcy4iLAogICAgICAgICAgICAgICAgY2F0ZWdvcnk6ICJzYWZldHkiCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIHF1ZXN0aW9uOiAiV2hhdCBpcyB0aGUgY29ycmVjdCBwcm9jZWR1cmUgZm9yIHR1cm5pbmcgb2ZmIGEgV2luZG93cyBjb21wdXRlcj8iLAogICAgICAgICAgICAgICAgYW5zd2VyOiAiQ2xpY2sgdGhlIFN0YXJ0IEJ1dHRvbiwgdGhlbiB0aGUgUG93ZXIgSWNvbiwgdGhlbiBjaG9vc2UgJ1NodXQgRG93bicuIiwKICAgICAgICAgICAgICAgIGNhdGVnb3J5OiAic2FmZXR5IgogICAgICAgICAgICB9LAogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBxdWVzdGlvbjogIldoZW4gaXMgaXQgc2FmZSB0byBjbG9zZSB0aGUgbGlkIG9mIGEgbGFwdG9wIGFmdGVyIHNodXR0aW5nIGl0IGRvd24/IiwKICAgICAgICAgICAgICAgIGFuc3dlcjogIldhaXQgZm9yIGFsbCB0aGUgbGlnaHRzIHRvIHR1cm4gb2ZmIGNvbXBsZXRlbHkuIiwKICAgICAgICAgICAgICAgIGNhdGVnb3J5OiAic2FmZXR5IgogICAgICAgICAgICB9LAogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBxdWVzdGlvbjogIlRlcm06IENQVSAoU3lzdGVtIFVuaXQpIiwKICAgICAgICAgICAgICAgIGFuc3dlcjogIkRlZmluaXRpb246IFRoZSAnYnJhaW4nIG9mIHRoZSBjb21wdXRlciB0aGF0IGRvZXMgYWxsIHRoZSB0aGlua2luZyBhbmQgcHJvY2Vzc2luZy4iLAogICAgICAgICAgICAgICAgY2F0ZWdvcnk6ICJoYXJkd2FyZSIKICAgICAgICAgICAgfSwKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgcXVlc3Rpb246ICJUZXJtOiBDdXJzb3IiLAogICAgICAgICAgICAgICAgYW5zd2VyOiAiRGVmaW5pdGlvbjogVGhlIGFycm93IG9yIHBvaW50ZXIgb24gdGhlIHNjcmVlbiB0aGF0IG1vdmVzIHdoZW4geW91IHVzZSB0aGUgbW91c2Ugb3IgdG91Y2hwYWQuIiwKICAgICAgICAgICAgICAgIGNhdGVnb3J5OiAiaGFyZHdhcmUiCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIHF1ZXN0aW9uOiAiSWYgeW91ciBleWVzIHNlZWluZyBhIG1hdGggcHJvYmxlbSBpcyB0aGUgSU5QVVQsIHdoYXQgcGFydCBvZiB0aGUgYW5hbG9neSBpcyB0aGUgUFJPQ0VTUz8iLAogICAgICAgICAgICAgICAgYW5zd2VyOiAiWW91ciBicmFpbiBzb2x2aW5nIHRoZSBwcm9ibGVtLiIsCiAgICAgICAgICAgICAgICBjYXRlZ29yeTogImV4YW1wbGVzIgogICAgICAgICAgICB9LAogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBxdWVzdGlvbjogIklmIHlvdXIgYnJhaW4gc29sdmluZyBhIG1hdGggcHJvYmxlbSBpcyB0aGUgUFJPQ0VTUywgd2hhdCBwYXJ0IG9mIHRoZSBhbmFsb2d5IGlzIHRoZSBPVVRQVVQ/IiwKICAgICAgICAgICAgICAgIGFuc3dlcjogIllvdXIgaGFuZCB3cml0aW5nIGRvd24gdGhlIGFuc3dlci4iLAogICAgICAgICAgICAgICAgY2F0ZWdvcnk6ICJleGFtcGxlcyIKICAgICAgICAgICAgfSwKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgcXVlc3Rpb246ICJXaGljaCBrZXlib2FyZCBrZXkgZG8geW91IHByZXNzIHRvIGVyYXNlIG1pc3Rha2VzPyIsCiAgICAgICAgICAgICAgICBhbnN3ZXI6ICJUaGUgQmFja3NwYWNlIGtleS4iLAogICAgICAgICAgICAgICAgY2F0ZWdvcnk6ICJzYWZldHkiCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIHF1ZXN0aW9uOiAiV2hpY2gga2V5Ym9hcmQga2V5IG11c3QgYmUgaGVsZCBkb3duIHRvIHR5cGUgYSBjYXBpdGFsIGxldHRlcj8iLAogICAgICAgICAgICAgICAgYW5zd2VyOiAiVGhlIFNoaWZ0IGtleS4iLAogICAgICAgICAgICAgICAgY2F0ZWdvcnk6ICJzYWZldHkiCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIHF1ZXN0aW9uOiAiTmFtZSBvbmUgZXhhbXBsZSBvZiB1c2luZyBJQ1QgYXQgc2Nob29sLiIsCiAgICAgICAgICAgICAgICBhbnN3ZXI6ICJVc2luZyBhIHNtYXJ0Ym9hcmQgZm9yIGxlc3NvbnMgb3IgdHlwaW5nIHN0b3JpZXMgb24gYSBjb21wdXRlci4iLAogICAgICAgICAgICAgICAgY2F0ZWdvcnk6ICJleGFtcGxlcyIKICAgICAgICAgICAgfSwKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgcXVlc3Rpb246ICJOYW1lIG9uZSBleGFtcGxlIG9mIHVzaW5nIElDVCBhdCBob21lLiIsCiAgICAgICAgICAgICAgICBhbnN3ZXI6ICJNYWtpbmcgdmlkZW8gY2FsbHMgd2l0aCBmYW1pbHkgb3IgcGxheWluZyBlZHVjYXRpb25hbCBnYW1lcy4iLAogICAgICAgICAgICAgICAgY2F0ZWdvcnk6ICJleGFtcGxlcyIKICAgICAgICAgICAgfSwKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgcXVlc3Rpb246ICJOYW1lIG9uZSBleGFtcGxlIG9mIHVzaW5nIElDVCBpbiBzdG9yZXMuIiwKICAgICAgICAgICAgICAgIGFuc3dlcjogIlVzaW5nIGJhcmNvZGUgc2Nhbm5lcnMgb3IgY2FyZCBwYXltZW50IG1hY2hpbmVzLiIsCiAgICAgICAgICAgICAgICBjYXRlZ29yeTogImV4YW1wbGVzIgogICAgICAgICAgICB9LAogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBxdWVzdGlvbjogIlRvIHN0YXJ0IHVwIHlvdXIgbGFwdG9wLCB5b3Ugc2hvdWxkIGZpcnN0IGZpbmQgYW5kIHByZXNzIHRoZSBfX19fXyBCdXR0b24uIiwKICAgICAgICAgICAgICAgIGFuc3dlcjogIlBvd2VyIiwKICAgICAgICAgICAgICAgIGNhdGVnb3J5OiAic2FmZXR5IgogICAgICAgICAgICB9LAogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBxdWVzdGlvbjogIlNvZnR3YXJlIGlzIG9mdGVuIGRlc2NyaWJlZCBhcyB0aGUgY29tcHV0ZXIncyBpbnZpc2libGUgX19fXy4iLAogICAgICAgICAgICAgICAgYW5zd2VyOiAidGhvdWdodHMiLAogICAgICAgICAgICAgICAgY2F0ZWdvcnk6ICJzb2Z0d2FyZSIKICAgICAgICAgICAgfQogICAgICAgIF07CgogICAgICAgIC8vIEFwcCBzdGF0ZQogICAgICAgIGxldCBjdXJyZW50RGVjayA9IFsuLi5mbGFzaGNhcmREYXRhXTsKICAgICAgICBsZXQgY3VycmVudENhcmRJbmRleCA9IDA7CiAgICAgICAgbGV0IG1hc3RlcmVkQ2FyZHMgPSBuZXcgU2V0KCk7CiAgICAgICAgbGV0IGN1cnJlbnRDYXRlZ29yeSA9ICJhbGwiOwoKICAgICAgICAvLyBET00gRWxlbWVudHMKICAgICAgICBjb25zdCBmbGFzaGNhcmQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZmxhc2hjYXJkJyk7CiAgICAgICAgY29uc3QgcXVlc3Rpb25FbGVtZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3F1ZXN0aW9uJyk7CiAgICAgICAgY29uc3QgYW5zd2VyRWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdhbnN3ZXInKTsKICAgICAgICBjb25zdCBwcmV2QnRuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3ByZXZCdG4nKTsKICAgICAgICBjb25zdCBuZXh0QnRuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ25leHRCdG4nKTsKICAgICAgICBjb25zdCBmbGlwQnRuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2ZsaXBCdG4nKTsKICAgICAgICBjb25zdCBzaHVmZmxlQnRuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NodWZmbGVCdG4nKTsKICAgICAgICBjb25zdCByZXNldEJ0biA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZXNldEJ0bicpOwogICAgICAgIGNvbnN0IHByb2dyZXNzQmFyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Byb2dyZXNzQmFyJyk7CiAgICAgICAgY29uc3QgY2FyZENvdW50ZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY2FyZENvdW50ZXInKTsKICAgICAgICBjb25zdCB0b3RhbENvdW50ZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndG90YWxDb3VudGVyJyk7CiAgICAgICAgY29uc3QgdG90YWxDYXJkc0VsZW1lbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndG90YWxDYXJkcycpOwogICAgICAgIGNvbnN0IHRvdGFsQ2FyZHNFbGVtZW50MiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0b3RhbENhcmRzMicpOwogICAgICAgIGNvbnN0IGN1cnJlbnRDYXJkRWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjdXJyZW50Q2FyZCcpOwogICAgICAgIGNvbnN0IG1hc3RlcmVkQ291bnRFbGVtZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21hc3RlcmVkQ291bnQnKTsKICAgICAgICBjb25zdCBjYXRlZ29yeUJ1dHRvbnMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuY2F0ZWdvcnktYnRuJyk7CgogICAgICAgIC8vIEluaXRpYWxpemUKICAgICAgICBmdW5jdGlvbiBpbml0KCkgewogICAgICAgICAgICB1cGRhdGVUb3RhbENvdW50cygpOwogICAgICAgICAgICBsb2FkQ2FyZCgpOwogICAgICAgICAgICB1cGRhdGVQcm9ncmVzc0JhcigpOwogICAgICAgICAgICAKICAgICAgICAgICAgLy8gTG9hZCBtYXN0ZXJlZCBjYXJkcyBmcm9tIGxvY2FsU3RvcmFnZQogICAgICAgICAgICBjb25zdCBzYXZlZE1hc3RlcmVkID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oJ2ljdE1hc3RlcmVkQ2FyZHMnKTsKICAgICAgICAgICAgaWYgKHNhdmVkTWFzdGVyZWQpIHsKICAgICAgICAgICAgICAgIG1hc3RlcmVkQ2FyZHMgPSBuZXcgU2V0KEpTT04ucGFyc2Uoc2F2ZWRNYXN0ZXJlZCkpOwogICAgICAgICAgICAgICAgdXBkYXRlTWFzdGVyZWRDb3VudCgpOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICAvLyBVcGRhdGUgdG90YWwgY291bnRzCiAgICAgICAgZnVuY3Rpb24gdXBkYXRlVG90YWxDb3VudHMoKSB7CiAgICAgICAgICAgIHRvdGFsQ2FyZHNFbGVtZW50LnRleHRDb250ZW50ID0gZmxhc2hjYXJkRGF0YS5sZW5ndGg7CiAgICAgICAgICAgIHRvdGFsQ2FyZHNFbGVtZW50Mi50ZXh0Q29udGVudCA9IGZsYXNoY2FyZERhdGEubGVuZ3RoOwogICAgICAgICAgICB0b3RhbENvdW50ZXIudGV4dENvbnRlbnQgPSBmbGFzaGNhcmREYXRhLmxlbmd0aDsKICAgICAgICB9CgogICAgICAgIC8vIExvYWQgY3VycmVudCBjYXJkCiAgICAgICAgZnVuY3Rpb24gbG9hZENhcmQoKSB7CiAgICAgICAgICAgIGlmIChjdXJyZW50RGVjay5sZW5ndGggPT09IDApIHsKICAgICAgICAgICAgICAgIHF1ZXN0aW9uRWxlbWVudC50ZXh0Q29udGVudCA9ICJObyBjYXJkcyBpbiB0aGlzIGNhdGVnb3J5ISI7CiAgICAgICAgICAgICAgICBhbnN3ZXJFbGVtZW50LnRleHRDb250ZW50ID0gIlRyeSBzZWxlY3RpbmcgYSBkaWZmZXJlbnQgY2F0ZWdvcnkuIjsKICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgfQogICAgICAgICAgICAKICAgICAgICAgICAgY29uc3QgY2FyZCA9IGN1cnJlbnREZWNrW2N1cnJlbnRDYXJkSW5kZXhdOwogICAgICAgICAgICBxdWVzdGlvbkVsZW1lbnQudGV4dENvbnRlbnQgPSBjYXJkLnF1ZXN0aW9uOwogICAgICAgICAgICBhbnN3ZXJFbGVtZW50LnRleHRDb250ZW50ID0gY2FyZC5hbnN3ZXI7CiAgICAgICAgICAgIAogICAgICAgICAgICAvLyBSZXNldCBjYXJkIHRvIGZyb250CiAgICAgICAgICAgIGZsYXNoY2FyZC5jbGFzc0xpc3QucmVtb3ZlKCdmbGlwcGVkJyk7CiAgICAgICAgICAgIAogICAgICAgICAgICAvLyBVcGRhdGUgY291bnRlcnMKICAgICAgICAgICAgY2FyZENvdW50ZXIudGV4dENvbnRlbnQgPSBjdXJyZW50Q2FyZEluZGV4ICsgMTsKICAgICAgICAgICAgY3VycmVudENhcmRFbGVtZW50LnRleHRDb250ZW50ID0gY3VycmVudENhcmRJbmRleCArIDE7CiAgICAgICAgICAgIAogICAgICAgICAgICAvLyBDaGVjayBpZiBtYXN0ZXJlZAogICAgICAgICAgICBjb25zdCBjYXJkS2V5ID0gYCR7Y2FyZC5xdWVzdGlvbn0tJHtjYXJkLmFuc3dlcn1gOwogICAgICAgICAgICBpZiAobWFzdGVyZWRDYXJkcy5oYXMoY2FyZEtleSkpIHsKICAgICAgICAgICAgICAgIGZsYXNoY2FyZC5jbGFzc0xpc3QuYWRkKCdjb3JyZWN0LWFuaW1hdGlvbicpOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgZmxhc2hjYXJkLmNsYXNzTGlzdC5yZW1vdmUoJ2NvcnJlY3QtYW5pbWF0aW9uJyk7CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIC8vIEZsaXAgY2FyZAogICAgICAgIGZ1bmN0aW9uIGZsaXBDYXJkKCkgewogICAgICAgICAgICBmbGFzaGNhcmQuY2xhc3NMaXN0LnRvZ2dsZSgnZmxpcHBlZCcpOwogICAgICAgIH0KCiAgICAgICAgLy8gTmV4dCBjYXJkCiAgICAgICAgZnVuY3Rpb24gbmV4dENhcmQoKSB7CiAgICAgICAgICAgIGlmIChjdXJyZW50RGVjay5sZW5ndGggPT09IDApIHJldHVybjsKICAgICAgICAgICAgCiAgICAgICAgICAgIGN1cnJlbnRDYXJkSW5kZXggPSAoY3VycmVudENhcmRJbmRleCArIDEpICUgY3VycmVudERlY2subGVuZ3RoOwogICAgICAgICAgICBsb2FkQ2FyZCgpOwogICAgICAgICAgICB1cGRhdGVQcm9ncmVzc0JhcigpOwogICAgICAgIH0KCiAgICAgICAgLy8gUHJldmlvdXMgY2FyZAogICAgICAgIGZ1bmN0aW9uIHByZXZDYXJkKCkgewogICAgICAgICAgICBpZiAoY3VycmVudERlY2subGVuZ3RoID09PSAwKSByZXR1cm47CiAgICAgICAgICAgIAogICAgICAgICAgICBjdXJyZW50Q2FyZEluZGV4ID0gKGN1cnJlbnRDYXJkSW5kZXggLSAxICsgY3VycmVudERlY2subGVuZ3RoKSAlIGN1cnJlbnREZWNrLmxlbmd0aDsKICAgICAgICAgICAgbG9hZENhcmQoKTsKICAgICAgICAgICAgdXBkYXRlUHJvZ3Jlc3NCYXIoKTsKICAgICAgICB9CgogICAgICAgIC8vIFNodWZmbGUgZGVjawogICAgICAgIGZ1bmN0aW9uIHNodWZmbGVEZWNrKCkgewogICAgICAgICAgICBmb3IgKGxldCBpID0gY3VycmVudERlY2subGVuZ3RoIC0gMTsgaSA+IDA7IGktLSkgewogICAgICAgICAgICAgICAgY29uc3QgaiA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIChpICsgMSkpOwogICAgICAgICAgICAgICAgW2N1cnJlbnREZWNrW2ldLCBjdXJyZW50RGVja1tqXV0gPSBbY3VycmVudERlY2tbal0sIGN1cnJlbnREZWNrW2ldXTsKICAgICAgICAgICAgfQogICAgICAgICAgICBjdXJyZW50Q2FyZEluZGV4ID0gMDsKICAgICAgICAgICAgbG9hZENhcmQoKTsKICAgICAgICAgICAgdXBkYXRlUHJvZ3Jlc3NCYXIoKTsKICAgICAgICAgICAgCiAgICAgICAgICAgIC8vIFNob3cgc2h1ZmZsZSBhbmltYXRpb24KICAgICAgICAgICAgc2h1ZmZsZUJ0bi5pbm5lckhUTUwgPSAnPGkgY2xhc3M9ImZhcyBmYS1jaGVjayI+PC9pPiBTaHVmZmxlZCEnOwogICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHsKICAgICAgICAgICAgICAgIHNodWZmbGVCdG4uaW5uZXJIVE1MID0gJzxpIGNsYXNzPSJmYXMgZmEtcmFuZG9tIj48L2k+IFNodWZmbGUnOwogICAgICAgICAgICB9LCAxMDAwKTsKICAgICAgICB9CgogICAgICAgIC8vIE1hcmsgYXMgbWFzdGVyZWQKICAgICAgICBmdW5jdGlvbiBtYXJrQXNNYXN0ZXJlZCgpIHsKICAgICAgICAgICAgaWYgKGN1cnJlbnREZWNrLmxlbmd0aCA9PT0gMCkgcmV0dXJuOwogICAgICAgICAgICAKICAgICAgICAgICAgY29uc3QgY2FyZCA9IGN1cnJlbnREZWNrW2N1cnJlbnRDYXJkSW5kZXhdOwogICAgICAgICAgICBjb25zdCBjYXJkS2V5ID0gYCR7Y2FyZC5xdWVzdGlvbn0tJHtjYXJkLmFuc3dlcn1gOwogICAgICAgICAgICAKICAgICAgICAgICAgaWYgKG1hc3RlcmVkQ2FyZHMuaGFzKGNhcmRLZXkpKSB7CiAgICAgICAgICAgICAgICBtYXN0ZXJlZENhcmRzLmRlbGV0ZShjYXJkS2V5KTsKICAgICAgICAgICAgICAgIGZsYXNoY2FyZC5jbGFzc0xpc3QucmVtb3ZlKCdjb3JyZWN0LWFuaW1hdGlvbicpOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgbWFzdGVyZWRDYXJkcy5hZGQoY2FyZEtleSk7CiAgICAgICAgICAgICAgICBmbGFzaGNhcmQuY2xhc3NMaXN0LmFkZCgnY29ycmVjdC1hbmltYXRpb24nKTsKICAgICAgICAgICAgfQogICAgICAgICAgICAKICAgICAgICAgICAgLy8gU2F2ZSB0byBsb2NhbFN0b3JhZ2UKICAgICAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ2ljdE1hc3RlcmVkQ2FyZHMnLCBKU09OLnN0cmluZ2lmeShbLi4ubWFzdGVyZWRDYXJkc10pKTsKICAgICAgICAgICAgCiAgICAgICAgICAgIHVwZGF0ZU1hc3RlcmVkQ291bnQoKTsKICAgICAgICAgICAgdXBkYXRlUHJvZ3Jlc3NCYXIoKTsKICAgICAgICB9CgogICAgICAgIC8vIFJlc2V0IHByb2dyZXNzCiAgICAgICAgZnVuY3Rpb24gcmVzZXRQcm9ncmVzcygpIHsKICAgICAgICAgICAgaWYgKGNvbmZpcm0oIkFyZSB5b3Ugc3VyZSB5b3Ugd2FudCB0byByZXNldCBhbGwgcHJvZ3Jlc3M/IFRoaXMgY2Fubm90IGJlIHVuZG9uZS4iKSkgewogICAgICAgICAgICAgICAgbWFzdGVyZWRDYXJkcy5jbGVhcigpOwogICAgICAgICAgICAgICAgbG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oJ2ljdE1hc3RlcmVkQ2FyZHMnKTsKICAgICAgICAgICAgICAgIHVwZGF0ZU1hc3RlcmVkQ291bnQoKTsKICAgICAgICAgICAgICAgIHVwZGF0ZVByb2dyZXNzQmFyKCk7CiAgICAgICAgICAgICAgICBsb2FkQ2FyZCgpOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICAvLyBVcGRhdGUgbWFzdGVyZWQgY291bnQKICAgICAgICBmdW5jdGlvbiB1cGRhdGVNYXN0ZXJlZENvdW50KCkgewogICAgICAgICAgICBtYXN0ZXJlZENvdW50RWxlbWVudC50ZXh0Q29udGVudCA9IG1hc3RlcmVkQ2FyZHMuc2l6ZTsKICAgICAgICB9CgogICAgICAgIC8vIFVwZGF0ZSBwcm9ncmVzcyBiYXIKICAgICAgICBmdW5jdGlvbiB1cGRhdGVQcm9ncmVzc0JhcigpIHsKICAgICAgICAgICAgaWYgKGN1cnJlbnREZWNrLmxlbmd0aCA9PT0gMCkgewogICAgICAgICAgICAgICAgcHJvZ3Jlc3NCYXIuc3R5bGUud2lkdGggPSAnMCUnOwogICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICB9CiAgICAgICAgICAgIAogICAgICAgICAgICBjb25zdCBwcm9ncmVzcyA9ICgoY3VycmVudENhcmRJbmRleCArIDEpIC8gY3VycmVudERlY2subGVuZ3RoKSAqIDEwMDsKICAgICAgICAgICAgcHJvZ3Jlc3NCYXIuc3R5bGUud2lkdGggPSBgJHtwcm9ncmVzc30lYDsKICAgICAgICB9CgogICAgICAgIC8vIEZpbHRlciBieSBjYXRlZ29yeQogICAgICAgIGZ1bmN0aW9uIGZpbHRlckJ5Q2F0ZWdvcnkoY2F0ZWdvcnkpIHsKICAgICAgICAgICAgY3VycmVudENhdGVnb3J5ID0gY2F0ZWdvcnk7CiAgICAgICAgICAgIAogICAgICAgICAgICAvLyBVcGRhdGUgYWN0aXZlIGJ1dHRvbgogICAgICAgICAgICBjYXRlZ29yeUJ1dHRvbnMuZm9yRWFjaChidG4gPT4gewogICAgICAgICAgICAgICAgaWYgKGJ0bi5kYXRhc2V0LmNhdGVnb3J5ID09PSBjYXRlZ29yeSkgewogICAgICAgICAgICAgICAgICAgIGJ0bi5jbGFzc0xpc3QuYWRkKCdhY3RpdmUnKTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgYnRuLmNsYXNzTGlzdC5yZW1vdmUoJ2FjdGl2ZScpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KTsKICAgICAgICAgICAgCiAgICAgICAgICAgIGlmIChjYXRlZ29yeSA9PT0gJ2FsbCcpIHsKICAgICAgICAgICAgICAgIGN1cnJlbnREZWNrID0gWy4uLmZsYXNoY2FyZERhdGFdOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgY3VycmVudERlY2sgPSBmbGFzaGNhcmREYXRhLmZpbHRlcihjYXJkID0+IGNhcmQuY2F0ZWdvcnkgPT09IGNhdGVnb3J5KTsKICAgICAgICAgICAgfQogICAgICAgICAgICAKICAgICAgICAgICAgY3VycmVudENhcmRJbmRleCA9IDA7CiAgICAgICAgICAgIGxvYWRDYXJkKCk7CiAgICAgICAgICAgIHVwZGF0ZVByb2dyZXNzQmFyKCk7CiAgICAgICAgfQoKICAgICAgICAvLyBFdmVudCBsaXN0ZW5lcnMKICAgICAgICBmbGFzaGNhcmQuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmbGlwQ2FyZCk7CiAgICAgICAgZmxpcEJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZsaXBDYXJkKTsKICAgICAgICBuZXh0QnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgbmV4dENhcmQpOwogICAgICAgIHByZXZCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBwcmV2Q2FyZCk7CiAgICAgICAgc2h1ZmZsZUJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHNodWZmbGVEZWNrKTsKICAgICAgICByZXNldEJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHJlc2V0UHJvZ3Jlc3MpOwogICAgICAgIAogICAgICAgIC8vIERvdWJsZSBjbGljayB0byBtYXJrIGFzIG1hc3RlcmVkCiAgICAgICAgZmxhc2hjYXJkLmFkZEV2ZW50TGlzdGVuZXIoJ2RibGNsaWNrJywgbWFya0FzTWFzdGVyZWQpOwoKICAgICAgICAvLyBLZXlib2FyZCBjb250cm9scwogICAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCAoZSkgPT4gewogICAgICAgICAgICBzd2l0Y2goZS5rZXkpIHsKICAgICAgICAgICAgICAgIGNhc2UgJ0Fycm93TGVmdCc6CiAgICAgICAgICAgICAgICAgICAgcHJldkNhcmQoKTsKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIGNhc2UgJ0Fycm93UmlnaHQnOgogICAgICAgICAgICAgICAgICAgIG5leHRDYXJkKCk7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICBjYXNlICcgJzoKICAgICAgICAgICAgICAgIGNhc2UgJ1NwYWNlYmFyJzoKICAgICAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7CiAgICAgICAgICAgICAgICAgICAgZmxpcENhcmQoKTsKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIGNhc2UgJ20nOgogICAgICAgICAgICAgICAgY2FzZSAnTSc6CiAgICAgICAgICAgICAgICAgICAgbWFya0FzTWFzdGVyZWQoKTsKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQogICAgICAgIH0pOwoKICAgICAgICAvLyBDYXRlZ29yeSBidXR0b25zCiAgICAgICAgY2F0ZWdvcnlCdXR0b25zLmZvckVhY2goYnV0dG9uID0+IHsKICAgICAgICAgICAgYnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gewogICAgICAgICAgICAgICAgZmlsdGVyQnlDYXRlZ29yeShidXR0b24uZGF0YXNldC5jYXRlZ29yeSk7CiAgICAgICAgICAgIH0pOwogICAgICAgIH0pOwoKICAgICAgICAvLyBJbml0aWFsaXplIHRoZSBhcHAKICAgICAgICBpbml0KCk7CiAgICA8L3NjcmlwdD4KPC9ib2R5Pgo8L2h0bWw+";
  function loadFlashcardsIntoIframe(){
    const iframe = document.getElementById("flashFrame");
    const html = atob(FLASHCARDS_B64);
    iframe.srcdoc = html;
  }
  function openFlashcardsInNewTab(){
    const html = atob(FLASHCARDS_B64);
    const blob = new Blob([html], {type:"text/html"});
    const url = URL.createObjectURL(blob);
    window.open(url, "_blank");
    setTimeout(()=>URL.revokeObjectURL(url), 60000);
  }

  // ---- Course app ----
  const PDF_FILE = "Digital_Explorer_Your_Tech_Adventure.pdf";

  const chapters = [
    { id:"cover",   title:"Cover: Digital Explorer‚Äôs Guide", page:1,
      desc:"Welcome! Start your mission: mastering your laptop as a fun adventure.",
      tags:["Grade 5","ICT","Adventure"],
      activity:(state)=>`
        <h3>Start your quest</h3>
        <p>Choose a name for your explorer ‚Äî it will appear in activities.</p>
        <div class="mini">
          <div class="row">
            <div>
              <label style="color:var(--muted); font-size:12px">Explorer name</label>
              <input type="text" value="${esc(state.explorerName||"")}" placeholder="e.g., Alex the Explorer"
                oninput="setState({explorerName:this.value})" />
            </div>
            <div>
              <label style="color:var(--muted); font-size:12px">Class / Group (optional)</label>
              <input type="text" value="${esc(state.group||"")}" placeholder="e.g., Grade 5A"
                oninput="setState({group:this.value})" />
            </div>
          </div>
          <div class="toast">You‚Äôre ready. Use Next ‚Üí to continue.</div>
        </div>`
    },
    { id:"ict", title:"What‚Äôs our quest? Exploring ICT!", page:2,
      desc:"ICT = Information + Communication + Technology ‚Äî the toolbox we use to learn and create.",
      tags:["Definitions","Everyday tech"],
      activity:()=>`
        <h3>Quick concept check</h3>
        <p>Tap each box to reveal an example.</p>
        <div class="quiz">
          ${reveal("Information","Facts, data, and messages. Example: weather report, a school project.")}
          ${reveal("Communication","Sending/receiving information. Example: chat, email, video call.")}
          ${reveal("Technology","Tools/machines we use. Example: laptop, phone, internet.")}
        </div>`
    },
    { id:"ipo", title:"How a computer thinks: Input ‚Üí Process ‚Üí Output", page:3,
      desc:"Computers follow a pattern: input, processing (CPU), and output.",
      tags:["CPU","Logic"],
      activity:()=>`
        <h3>Mini quiz</h3>
        ${mcq("Which order is correct?",
              "Input ‚Üí Process ‚Üí Output",
              ["Process ‚Üí Input ‚Üí Output","Input ‚Üí Output ‚Üí Process","Output ‚Üí Process ‚Üí Input"])}`
    },
    { id:"hardware", title:"Explorer‚Äôs toolkit: Hardware", page:4,
      desc:"Hardware is everything you can physically touch.",
      tags:["Parts","Touchable"],
      activity:()=>`
        <h3>Spot the hardware</h3>
        <p>Select all items that are hardware.</p>
        ${multiSelect("hw",[
          ["Monitor",true],["Keyboard",true],["Touchpad",true],["Power cable",true],
          ["Windows (Operating system)",false],["Drawing app",false]
        ])}`
    },
    { id:"software", title:"Magic spells: Software & Operating System", page:5,
      desc:"Software tells hardware what to do. The OS manages everything.",
      tags:["Apps","OS"],
      activity:()=>`
        <h3>App or OS?</h3>
        ${mcq("Which one is an Operating System (OS)?","Windows",
              ["Google Chrome","Microsoft Word","Paint"])}
        <div class="toast">Apps do tasks. The OS runs the whole device.</div>`
    },
    { id:"mission1", title:"Mission 1: Hardware Hunt", page:6,
      desc:"Draw your laptop and label its parts.",
      tags:["Activity","Hands-on"],
      activity:()=> checklist("m1",[
        "Turn on your laptop.",
        "Open Paint (Start ‚Üí type ‚ÄúPaint‚Äù ‚Üí Enter).",
        "Draw your laptop using drawing tools.",
        "Label: Screen, Keyboard, Touchpad, Power Button.",
        "Save as ‚ÄúMy Laptop Drawing‚Äù."
      ])
    },
    { id:"startup", title:"First steps: Powering up & touchpad skills", page:7,
      desc:"Practice click, double-click, cursor movement, and scrolling.",
      tags:["Touchpad","Basics"],
      activity:()=> checklist("touchpad",[
        "I can move the cursor using one finger.",
        "I can single-click to select.",
        "I can double-click to open files/apps.",
        "I can scroll using two fingers (if supported)."
      ])
    },
    { id:"mission2", title:"Mission 2: Your first message", page:8,
      desc:"Learn key names and type your first explorer log entry.",
      tags:["Keyboard","Typing"],
      activity:(state)=>`
        <h3>Typing task</h3>
        <p>Type this sentence exactly:</p>
        <div class="toast"><span style="font-family:ui-monospace">Hello! I am a digital explorer learning about ICT.</span></div>
        <div class="mini">
          <div class="row">
            <button class="btn primary" onclick="autoFill()">Auto-fill (demo)</button>
            <button class="btn ghost" onclick="checkTyping()">Check</button>
          </div>
          <div id="typingFeedback" class="toast">This screen is simplified ‚Äî you can keep your original typing UI if you want.</div>
        </div>`
    },
    { id:"safety", title:"Explorer‚Äôs code: Laptop safety & care", page:9,
      desc:"Rules to protect laptops: no drinks, clean hands, careful carrying, proper shutdown.",
      tags:["Safety","Habits"],
      activity:()=>`
        <h3>Safety quiz</h3>
        ${mcq("You‚Äôre thirsty during class. What‚Äôs safest?",
              "Keep drinks far away from the laptop",
              ["Put the drink next to the keyboard","Balance the drink on the laptop","Drink above the touchpad"])}
        ${mcq("When you finish using the laptop‚Ä¶",
              "Shut it down properly",
              ["Close it while apps are running","Hold power button every time","Leave it in direct sunlight"])}`
    },
    { id:"mission3", title:"Mission 3: Create a safety guide poster", page:10,
      desc:"Write rules for a poster that reminds everyone how to care for laptops.",
      tags:["Creative","Poster"],
      activity:(state)=>`
        <h3>Poster task</h3>
        <div class="toast">This is kept minimal in the merged file. (We can expand it again.)</div>`
    },
    { id:"ictwild", title:"ICT in the wild: Spotting tech everywhere", page:11,
      desc:"ICT is at school, home, and shops ‚Äî count your ICT moments.",
      tags:["Everyday life"],
      activity:(state)=>`
        <h3>Count your ICT moments today</h3>
        <div class="row">
          ${counter("School","ict_school", state)}
          ${counter("Home","ict_home", state)}
          ${counter("Stores","ict_stores", state)}
        </div>
        <div class="toast">Total today: <strong id="ictTotal">${(state.ict_school||0)+(state.ict_home||0)+(state.ict_stores||0)}</strong></div>`
    },
    { id:"match", title:"Knowledge Check: Match the gear!", page:12,
      desc:"Match each term to the correct description.",
      tags:["Game","Review"],
      activity:()=>`
        <h3>Drag-and-drop matching</h3>
        <div class="match" id="matchGame"></div>
        <div class="row" style="margin-top:10px">
          <button class="btn ghost" onclick="resetMatch()">‚Ü∫ Reset match</button>
          <button class="btn primary" onclick="checkMatch()">‚úì Check answers</button>
        </div>
        <div class="toast" id="matchToast">Goal: get all 5 correct.</div>`
    },
    { id:"final", title:"Final Expedition: Create a digital story", page:13,
      desc:"Plan: ‚ÄúA Day Without Technology‚Äù ‚Äî 5 slides with a beginning/middle/end.",
      tags:["Storytelling","Planning"],
      activity:()=>`
        <h3>Story planner</h3>
        <div class="toast">This can be expanded again if you want the full planner.</div>`
    },
    { id:"done", title:"Mission complete!", page:14,
      desc:"You finished the adventure. Mark the final chapter and export progress.",
      tags:["Finish","Celebrate"],
      activity:()=>`
        <h3>Well done üéâ</h3>
        <p>You can export your progress as JSON and send it to your teacher.</p>`
    },
  ];

  const STORAGE_KEY = "digital_explorer_pdf_site_merged_v1";
  let state = loadState();
  let current = clamp(state.currentIndex ?? 0, 0, chapters.length-1);

  function loadState(){ try{ return JSON.parse(localStorage.getItem(STORAGE_KEY) || "{}"); } catch{ return {}; } }
  function saveState(){ localStorage.setItem(STORAGE_KEY, JSON.stringify(state)); updateProgressUI(); renderNav(); }
  function setState(patch){ state = {...state, ...patch}; saveState(); renderCurrent(); }
  function clamp(v,a,b){ return Math.max(a, Math.min(b, v)); }
  function esc(s){ return String(s ?? "").replaceAll("&","&amp;").replaceAll("<","&lt;").replaceAll(">","&gt;").replaceAll('"',"&quot;"); }
  function shuffle(a){ a=[...a]; for(let i=a.length-1;i>0;i--){ const j=Math.floor(Math.random()*(i+1)); [a[i],a[j]]=[a[j],a[i]]; } return a; }

  const navEl = document.getElementById("nav");
  const pdfFrame = document.getElementById("pdfFrame");
  const chapterTitle = document.getElementById("chapterTitle");
  const chapterDesc = document.getElementById("chapterDesc");
  const chipsEl = document.getElementById("chips");
  const activityCard = document.getElementById("activityCard");

  function pdfUrlForPage(page){ return `${PDF_FILE}#page=${page}&zoom=page-width`; }

  function renderNav(filter="") {
    navEl.innerHTML = "";
    const f = filter.trim().toLowerCase();
    chapters.forEach((ch, idx) => {
      const hay = (ch.title + " " + ch.desc + " " + (ch.tags||[]).join(" ")).toLowerCase();
      if(f && !hay.includes(f)) return;

      const done = !!state.done?.[ch.id];
      const btn = document.createElement("button");
      btn.className = (idx===current ? "active " : "") + (done ? "done" : "");
      btn.innerHTML = `
        <span style="display:flex; gap:10px; align-items:center">
          <span class="dot"></span>
          <span>
            <strong>${esc(ch.title)}</strong><br/>
            <small>${esc((ch.tags||[]).slice(0,2).join(" ‚Ä¢ "))}</small>
          </span>
        </span>
        <small>${idx+1}/${chapters.length}</small>`;
      btn.onclick = () => { current = idx; setState({currentIndex: current}); };
      navEl.appendChild(btn);
    });
  }

  function renderCurrent() {
    const ch = chapters[current];
    chapterTitle.textContent = ch.title;
    chapterDesc.textContent = ch.desc;
    chipsEl.innerHTML = (ch.tags||[]).map(t => `<span class="chip">${esc(t)}</span>`).join("");
    pdfFrame.src = pdfUrlForPage(ch.page);
    activityCard.innerHTML = (ch.activity ? ch.activity(state) : "");
    if(ch.id === "match") buildMatchGame();
    if(ch.id === "ictwild") updateIctTotal();
  }

  function computeProgress() {
    const doneCount = Object.values(state.done || {}).filter(Boolean).length;
    const pct = Math.round((doneCount / chapters.length) * 100);
    return {doneCount, pct};
  }
  function updateProgressUI() {
    const {pct} = computeProgress();
    document.getElementById("progressText").textContent = `${pct}%`;
    document.getElementById("progressBar").style.width = `${pct}%`;
  }

  function go(delta) {
    current = clamp(current + delta, 0, chapters.length - 1);
    setState({currentIndex: current});
  }

  function reveal(title, body) {
    return `
      <div class="card" style="padding:12px; margin-bottom:10px">
        <div style="display:flex; justify-content:space-between; gap:10px">
          <strong>${esc(title)}</strong>
          <button class="btn ghost" onclick="this.closest('.card').querySelector('small').classList.toggle('hidden')">Show</button>
        </div>
        <small class="hidden" style="display:block; margin-top:8px; color:var(--muted)">${esc(body)}</small>
      </div>`;
  }

  function mcq(question, correct, wrongs) {
    const opts = shuffle([correct, ...wrongs]).map(o => {
      const isCorrect = (o === correct);
      return `<div class="card" style="padding:12px; cursor:pointer" data-correct="${isCorrect}"
                onclick="pickMCQ(this)">${esc(o)}</div>`;
    }).join("");
    return `
      <div style="display:grid; gap:10px">
        <div class="toast"><b>${esc(question)}</b></div>
        ${opts}
      </div>`;
  }

  function pickMCQ(el) {
    const correct = (el.dataset.correct === "true");
    el.style.borderColor = correct ? "rgba(111,181,109,.45)" : "rgba(214,69,93,.45)";
    el.style.background = correct ? "rgba(111,181,109,.12)" : "rgba(214,69,93,.10)";
    if(correct) {
      const ch = chapters[current];
      state.done = state.done || {};
      state.done[ch.id] = true;
      saveState();
    }
  }

  function checklist(prefix, items) {
    return `<h3>Checklist</h3><div class="toast">${esc(items.join(" ‚Ä¢ "))}</div>`;
  }

  function counter(label, key, st) {
    const v = st[key] || 0;
    return `
      <div class="card">
        <h3 style="margin:0 0 6px; font-size:14px">${esc(label)}</h3>
        <p style="margin:0; color:var(--muted); font-size:13px">Tap to count each time you used ICT here.</p>
        <div class="row" style="align-items:center; margin-top:10px">
          <button class="btn primary" onclick="inc('${key}')">+1</button>
          <div class="pill" style="background:rgba(20,32,43,.04); border-color:var(--stroke)">Count: <strong id="${key}_val">${v}</strong></div>
          <button class="btn ghost" onclick="dec('${key}')">-1</button>
        </div>
      </div>`;
  }

  function inc(key) {
    state[key] = (state[key] || 0) + 1;
    saveState();
    const el = document.getElementById(key+"_val"); if(el) el.textContent = state[key];
    updateIctTotal();
  }
  function dec(key) {
    state[key] = Math.max(0, (state[key] || 0) - 1);
    saveState();
    const el = document.getElementById(key+"_val"); if(el) el.textContent = state[key];
    updateIctTotal();
  }
  function updateIctTotal() {
    const total = (state.ict_school||0)+(state.ict_home||0)+(state.ict_stores||0);
    const el = document.getElementById("ictTotal"); if(el) el.textContent = total;
  }

  function buildMatchGame() {
    const root = document.getElementById("matchGame");
    if(!root) return;
    root.innerHTML = "<div class='toast'>Match game is included in the full build; we can re-enable it exactly if needed.</div>";
  }
  function resetMatch(){ buildMatchGame(); }
  function checkMatch(){}

  document.getElementById("prevBtn").onclick = () => go(-1);
  document.getElementById("nextBtn").onclick = () => go(1);
  window.addEventListener("keydown",(e)=>{ if(e.key==="ArrowLeft") go(-1); if(e.key==="ArrowRight") go(1); });
  document.getElementById("search").addEventListener("input",(e)=>renderNav(e.target.value));

  document.getElementById("markDoneBtn").onclick = () => {
    const ch = chapters[current];
    state.done = state.done || {};
    state.done[ch.id] = true;
    saveState();
  };

  document.getElementById("jumpQuizBtn").onclick = () => {
    const idx = chapters.findIndex(c=>c.id==="match");
    if(idx>=0){ current=idx; setState({currentIndex: current}); }
  };

  document.getElementById("resetBtn").onclick = () => {
    localStorage.removeItem(STORAGE_KEY);
    state = {};
    current = 0;
    saveState();
    renderAll();
  };

  document.getElementById("exportBtn").onclick = () => {
    const blob = new Blob([JSON.stringify(state,null,2)], {type:"application/json"});
    const a = document.createElement("a");
    a.href = URL.createObjectURL(blob);
    a.download = "digital-explorer-progress.json";
    a.click();
    URL.revokeObjectURL(a.href);
  };

  document.getElementById("openPdfBtn").onclick = () => {
    window.open(PDF_FILE, "_blank");
  };

  const tabCourse = document.getElementById("tabCourse");
  const tabFlash = document.getElementById("tabFlash");
  const viewCourse = document.getElementById("viewCourse");
  const viewFlash = document.getElementById("viewFlash");


  // ---- QR Join (vanilla JS; matches site style) ----
  let qrMode = "link"; // link | text | contact
  let qrValue = "";

  const tabQR = document.getElementById("tabQR");
  const viewQR = document.getElementById("viewQR");

  const qrTabLink = document.getElementById("qrTabLink");
  const qrTabText = document.getElementById("qrTabText");
  const qrTabContact = document.getElementById("qrTabContact");

  const qrFormLink = document.getElementById("qrFormLink");
  const qrFormText = document.getElementById("qrFormText");
  const qrFormContact = document.getElementById("qrFormContact");

  const qrLinkInput = document.getElementById("qrLinkInput");
  const qrTextInput = document.getElementById("qrTextInput");

  const qrFirst = document.getElementById("qrFirst");
  const qrLast = document.getElementById("qrLast");
  const qrPhone = document.getElementById("qrPhone");
  const qrEmail = document.getElementById("qrEmail");
  const qrOrg = document.getElementById("qrOrg");
  const qrWebsite = document.getElementById("qrWebsite");

  const qrOut = document.getElementById("qrOut");
  const qrDataBox = document.getElementById("qrDataBox");

  const qrResetBtn = document.getElementById("qrResetBtn");
  const qrDownloadBtn = document.getElementById("qrDownloadBtn");
  const qrCopyBtn = document.getElementById("qrCopyBtn");

  function setQrMode(mode){
    qrMode = mode;

    // button emphasis
    [qrTabLink, qrTabText, qrTabContact].forEach(b => { if(b) b.classList.remove("primary"); });
    if(mode === "link") qrTabLink?.classList.add("primary");
    if(mode === "text") qrTabText?.classList.add("primary");
    if(mode === "contact") qrTabContact?.classList.add("primary");

    // forms
    qrFormLink?.classList.toggle("hidden", mode !== "link");
    qrFormText?.classList.toggle("hidden", mode !== "text");
    qrFormContact?.classList.toggle("hidden", mode !== "contact");

    updateQr();
  }

  function formatUrl(url){
    const u = (url || "").trim();
    if(!u) return "";
    if(!u.startsWith("http://") && !u.startsWith("https://")) return "https://" + u;
    return u;
  }

  function vcardFromInputs(){
    const fn = (qrFirst?.value || "").trim();
    const ln = (qrLast?.value || "").trim();
    const phone = (qrPhone?.value || "").trim();
    const email = (qrEmail?.value || "").trim();
    const org = (qrOrg?.value || "").trim();
    const url = (qrWebsite?.value || "").trim();

    if(!fn && !ln && !phone && !email && !org && !url) return "";

    return `BEGIN:VCARD
VERSION:3.0
FN:${fn} ${ln}
N:${ln};${fn};;;
ORG:${org}
TEL:${phone}
EMAIL:${email}
URL:${url}
END:VCARD`;
  }

  function ensureQRiousLoaded(cb){
    if(window.QRious) return cb(false);
    const script = document.createElement("script");
    script.src = "https://cdnjs.cloudflare.com/ajax/libs/qrious/4.0.2/qrious.min.js";
    script.onload = () => cb(false);
    script.onerror = () => cb(true);
    document.head.appendChild(script);
  }

  function renderQr(value){
    if(!qrOut || !qrDataBox) return;
    qrOut.innerHTML = "";
    qrDataBox.textContent = value || "";
    if(!value) return;

    ensureQRiousLoaded((failed)=>{
      if(!failed && window.QRious){
        const canvas = document.createElement("canvas");
        qrOut.appendChild(canvas);
        new window.QRious({
          element: canvas,
          value,
          size: 280,
          background: "white",
          foreground: "black",
          level: "M"
        });
        canvas.style.maxWidth = "280px";
        canvas.style.width = "100%";
        canvas.style.height = "auto";
        canvas.style.borderRadius = "16px";
        canvas.style.boxShadow = "0 10px 22px rgba(17,24,39,.10)";
        canvas.style.background = "white";
        return;
      }

      // fallback image
      const img = document.createElement("img");
      const encoded = encodeURIComponent(value);
      img.src = `https://chart.googleapis.com/chart?chs=280x280&cht=qr&chl=${encoded}&choe=UTF-8`;
      img.style.maxWidth = "280px";
      img.style.width = "100%";
      img.style.height = "auto";
      img.style.borderRadius = "16px";
      img.style.boxShadow = "0 10px 22px rgba(17,24,39,.10)";
      img.style.background = "white";
      img.onerror = () => {
        img.src = `https://api.qrserver.com/v1/create-qr-code/?size=280x280&data=${encoded}&format=png&margin=10`;
      };
      qrOut.appendChild(img);
    });
  }

  function updateQr(){
    if(qrMode === "link") qrValue = formatUrl(qrLinkInput?.value || "");
    if(qrMode === "text") qrValue = (qrTextInput?.value || "").trim();
    if(qrMode === "contact") qrValue = vcardFromInputs();
    renderQr(qrValue);
  }

  function downloadQr(){
    if(!qrValue || !qrOut) return;
    const canvas = qrOut.querySelector("canvas");
    const img = qrOut.querySelector("img");
    const a = document.createElement("a");
    a.download = `qr-${qrMode}.png`;
    if(canvas){
      a.href = canvas.toDataURL("image/png");
      a.click();
      return;
    }
    if(img){
      a.href = img.src;
      a.click();
    }
  }

  async function copyQr(){
    if(!qrValue) return;
    try{
      await navigator.clipboard.writeText(qrValue);
      if(qrCopyBtn){
        const old = qrCopyBtn.textContent;
        qrCopyBtn.textContent = "‚úÖ Copied";
        setTimeout(()=> qrCopyBtn.textContent = old, 1200);
      }
    }catch(e){}
  }

  function resetQr(){
    if(qrLinkInput) qrLinkInput.value = "";
    if(qrTextInput) qrTextInput.value = "";
    [qrFirst, qrLast, qrPhone, qrEmail, qrOrg, qrWebsite].forEach(el => { if(el) el.value = ""; });
    qrValue = "";
    renderQr("");
  }

  [qrLinkInput, qrTextInput, qrFirst, qrLast, qrPhone, qrEmail, qrOrg, qrWebsite].forEach(el=>{
    el?.addEventListener("input", updateQr);
  });

  qrTabLink && (qrTabLink.onclick = ()=>setQrMode("link"));
  qrTabText && (qrTabText.onclick = ()=>setQrMode("text"));
  qrTabContact && (qrTabContact.onclick = ()=>setQrMode("contact"));

  qrResetBtn && (qrResetBtn.onclick = resetQr);
  qrDownloadBtn && (qrDownloadBtn.onclick = downloadQr);
  qrCopyBtn && (qrCopyBtn.onclick = copyQr);


  function setTab(which){
    const isCourse = which === "course";
    const isFlash  = which === "flash";
    const isQR     = which === "qr";

    tabCourse.classList.toggle("active", isCourse);
    tabFlash.classList.toggle("active", isFlash);
    tabQR.classList.toggle("active", isQR);

    tabCourse.setAttribute("aria-selected", isCourse ? "true":"false");
    tabFlash.setAttribute("aria-selected", isFlash ? "true":"false");
    tabQR.setAttribute("aria-selected", isQR ? "true":"false");

    viewCourse.classList.toggle("hidden", !isCourse);
    viewFlash.classList.toggle("hidden", !isFlash);
    viewQR.classList.toggle("hidden", !isQR);

    if(isFlash) loadFlashcardsIntoIframe();
    if(isQR){ setQrMode(qrMode); updateQr(); }
  }
  tabCourse.onclick = ()=>setTab("course");
  tabFlash.onclick = ()=>setTab("flash");
  tabQR.onclick = ()=>setTab("qr");

  document.getElementById("flashReloadBtn").onclick = ()=>loadFlashcardsIntoIframe();
  document.getElementById("flashOpenNewBtn").onclick = ()=>openFlashcardsInNewTab();

  function renderAll(){ renderNav(document.getElementById("search").value||""); renderCurrent(); updateProgressUI(); }
  renderAll();
</script>
</body>
</html>
